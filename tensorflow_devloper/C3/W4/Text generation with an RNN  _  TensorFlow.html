<!DOCTYPE html>
<!-- saved from url=(0057)https://www.tensorflow.org/text/tutorials/text_generation -->
<html lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="google-signin-client-id" content="157101835696-ooapojlodmuabs2do2vuhhnf90bccmoi.apps.googleusercontent.com">
    <meta name="google-signin-scope" content="profile email https://www.googleapis.com/auth/developerprofiles https://www.googleapis.com/auth/developerprofiles.award">
    <meta property="og:site_name" content="TensorFlow">
    <meta property="og:type" content="website"><meta name="theme-color" content="#ff6f00">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <link rel="manifest" href="https://www.tensorflow.org/_pwa/tensorflow/manifest.json" crossorigin="use-credentials">
    <link rel="preconnect" href="https://www.gstatic.com/" crossorigin="">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin="">
    <link rel="preconnect" href="https://apis.google.com/" crossorigin="">
    <link rel="preconnect" href="https://www.google-analytics.com/" crossorigin=""><link rel="stylesheet" href="./Text generation with an RNN  _  TensorFlow_files/css">
      <link rel="stylesheet" href="./Text generation with an RNN  _  TensorFlow_files/css2"><link rel="stylesheet" href="./Text generation with an RNN  _  TensorFlow_files/app.css">
      <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow/images/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow/images/apple-touch-icon-180x180.png"><link rel="canonical" href="https://www.tensorflow.org/text/tutorials/text_generation"><link rel="search" type="application/opensearchdescription+xml" title="TensorFlow" href="https://www.tensorflow.org/s/opensearch.xml">
      <link rel="alternate" hreflang="en" href="https://www.tensorflow.org/text/tutorials/text_generation"><link rel="alternate" hreflang="x-default" href="https://www.tensorflow.org/text/tutorials/text_generation"><link rel="alternate" hreflang="ar" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ar"><link rel="alternate" hreflang="bn" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=bn"><link rel="alternate" hreflang="fa" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fa"><link rel="alternate" hreflang="fr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fr"><link rel="alternate" hreflang="he" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=he"><link rel="alternate" hreflang="hi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=hi"><link rel="alternate" hreflang="id" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=id"><link rel="alternate" hreflang="it" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=it"><link rel="alternate" hreflang="ja" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ja"><link rel="alternate" hreflang="ko" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ko"><link rel="alternate" hreflang="pl" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pl"><link rel="alternate" hreflang="pt-BR" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pt-br"><link rel="alternate" hreflang="ru" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ru"><link rel="alternate" hreflang="es-419" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=es-419"><link rel="alternate" hreflang="th" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=th"><link rel="alternate" hreflang="tr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=tr"><link rel="alternate" hreflang="vi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=vi"><title>Text generation with an RNN &nbsp;|&nbsp; TensorFlow</title>

<meta property="og:title" content="Text generation with an RNN  |  TensorFlow"><meta property="og:url" content="https://www.tensorflow.org/text/tutorials/text_generation"><meta property="og:image" content="https://www.tensorflow.org/static/images/tf_logo_social.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="675"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary_large_image"><script src="./Text generation with an RNN  _  TensorFlow_files/cb=gapi.loaded_0" nonce="" async=""></script><script type="text/javascript" async="" src="./Text generation with an RNN  _  TensorFlow_files/js" nonce=""></script><script type="text/javascript" async="" src="./Text generation with an RNN  _  TensorFlow_files/destination" nonce=""></script><script type="text/javascript" async="" src="./Text generation with an RNN  _  TensorFlow_files/linkid.js.download" nonce=""></script><script async="" src="./Text generation with an RNN  _  TensorFlow_files/gtm.js.download" nonce=""></script><script async="" src="./Text generation with an RNN  _  TensorFlow_files/app_loader.js.download"></script><script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    
    "headline": "Text generation with an RNN"
  }
</script><script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "name": "Text",
      "item": "https://www.tensorflow.org/text"
    },{
      "@type": "ListItem",
      "position": 2,
      "name": "Text generation with an RNN",
      "item": "https://www.tensorflow.org/text/tutorials/text_generation"
    }]
  }
  </script>
  

  

  


    <script src="./Text generation with an RNN  _  TensorFlow_files/devsite_app_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_app_custom_elements_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_a11y_announce_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_analytics_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_badger_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_book_nav_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_bookmark_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_code_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_content_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_feature_tooltip_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_footer_linkboxes_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_footer_promos_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_footer_utility_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_header_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_heading_link_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_language_selector_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_notification_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_panel_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_progress_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_recommendations_sidebar_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_search_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_sitemask_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_snackbar_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_tabs_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_thumb_rating_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_toc_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_tooltip_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_user_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_view_release_notes_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/analytics.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_badge_awarded_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_dialog_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_fast_track_profile_creator_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_feedback_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_spinner_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_mwc_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_dropdown_list_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_view_release_notes_dialog_module.js.download" nonce=""></script><script src="./Text generation with an RNN  _  TensorFlow_files/devsite_devsite_checkbox_module.js.download" nonce=""></script><style id="abu-collapse-styles" type="text/css"></style><style type="text/css"></style><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><script type="text/javascript" charset="UTF-8" nonce="" src="./Text generation with an RNN  _  TensorFlow_files/api.js.download" gapi_processed="true"></script></head>
  <body class="" template="page" theme="tensorflow-theme" type="article" layout="docs" display-toc="" data-new-gr-c-s-check-loaded="14.1049.0" data-gr-ext-installed="" style="--devsite-js-header-height: 97px; --devsite-panel-height: 0px;" ready="">
    <devsite-progress id="app-progress"></devsite-progress>
  
    <section class="devsite-wrapper"><devsite-header role="banner" top-row--height="49" bottom-row--height="108" bottom-tabs--height="48" style="--devsite-js-top-row--height: 49px; --devsite-js-bottom-row--height: 108px; --devsite-js-bottom-tabs--height: 48px;" fixed="" offset="60" bottom-row--hidden="">
  
    























<div class="devsite-header--inner nocontent">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu" class="devsite-header-icon-button button-flat material-icons gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Navigation menu button" aria-label="Open menu">
        </button>
        <div class="devsite-product-name-wrapper">

  <a href="https://www.tensorflow.org/" class="devsite-site-logo-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Site logo" track-type="globalNav" track-name="tensorFlow" track-metadata-position="nav" track-metadata-eventdetail="nav">

  
    <img src="./Text generation with an RNN  _  TensorFlow_files/lockup.svg" class="devsite-site-logo" alt="TensorFlow">
  

</a>



  
  
  <span class="devsite-product-name">
    <ul class="devsite-breadcrumb-list">
  
  <li class="devsite-breadcrumb-item
             ">
    
    
    
      
      
    
  </li>
  
</ul>
  </span>

</div>
        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
            
              
              
  <devsite-tabs class="upper-tabs" connected="">

    

  <nav class="devsite-tabs-wrapper" aria-label="Upper tabs">
      
        
          <tab>
            
    <a href="https://www.tensorflow.org/install" track-metadata-eventdetail="https://www.tensorflow.org/install" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - install" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Install" track-name="install">
    Install
  
    </a>
  
  
          </tab>
        
      
        
          <tab dropdown="">
  
    <a href="https://www.tensorflow.org/learn" track-metadata-eventdetail="https://www.tensorflow.org/learn" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - learn" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Learn" track-name="learn">
    Learn
  
    </a>
  
  
    <a href="https://www.tensorflow.org/text/tutorials/text_generation#" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Dropdown menu for Learn" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/learn" track-metadata-position="nav - learn" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Learn" track-name="learn" class="devsite-tabs-dropdown-toggle devsite-icon devsite-icon-arrow-drop-down"></a>
  
  <div class="devsite-tabs-dropdown" aria-label="submenu" hidden="">
    
    <div class="devsite-tabs-dropdown-content">
      
        <div class="devsite-tabs-dropdown-column
                    tfo-menu-column-learn">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/learn" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/learn" track-metadata-position="nav - learn" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Introduction
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      New to TensorFlow?
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/overview" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/overview" track-metadata-position="nav - learn" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TensorFlow
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      The core open source ML library
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/js" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/js" track-metadata-position="nav - learn" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      For JavaScript
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      TensorFlow.js for ML using JavaScript
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/lite" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/lite" track-metadata-position="nav - learn" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      For Mobile &amp; Edge
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      TensorFlow Lite for mobile and edge devices
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/tfx" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/tfx" track-metadata-position="nav - learn" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      For Production
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      TensorFlow Extended for end-to-end ML components
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
    </div>
  </div>
</tab>
        
      
        
          <tab dropdown="">
  
    <a href="https://www.tensorflow.org/api" track-metadata-eventdetail="https://www.tensorflow.org/api" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - api" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api">
    API
  
    </a>
  
  
    <a href="https://www.tensorflow.org/text/tutorials/text_generation#" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Dropdown menu for API" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/api" track-metadata-position="nav - api" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api" class="devsite-tabs-dropdown-toggle devsite-icon devsite-icon-arrow-drop-down"></a>
  
  <div class="devsite-tabs-dropdown" aria-label="submenu" hidden="">
    
    <div class="devsite-tabs-dropdown-content">
      
        <div class="devsite-tabs-dropdown-column
                    ">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/api/stable" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/api/stable" track-metadata-position="nav - api" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TensorFlow (v2.14.0)
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/versions" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/versions" track-metadata-position="nav - api" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Versions…
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
        <div class="devsite-tabs-dropdown-column
                    ">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://js.tensorflow.org/api/latest/" track-type="nav" track-metadata-eventdetail="https://js.tensorflow.org/api/latest/" track-metadata-position="nav - api" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TensorFlow.js
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/lite/api_docs" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/lite/api_docs" track-metadata-position="nav - api" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TensorFlow Lite
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/tfx/api_docs" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/tfx/api_docs" track-metadata-position="nav - api" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TFX
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
    </div>
  </div>
</tab>
        
      
        
          <tab dropdown="" active="">
  
    <a href="https://www.tensorflow.org/resources" track-metadata-eventdetail="https://www.tensorflow.org/resources" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - resources" track-metadata-module="primary nav" aria-label="Resources, selected" data-category="Site-Wide Custom Events" data-label="Tab: Resources" track-name="resources">
    Resources
  
    </a>
  
  
    <a href="https://www.tensorflow.org/text/tutorials/text_generation#" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Dropdown menu for Resources" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/resources" track-metadata-position="nav - resources" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Resources" track-name="resources" class="devsite-tabs-dropdown-toggle devsite-icon devsite-icon-arrow-drop-down"></a>
  
  <div class="devsite-tabs-dropdown" aria-label="submenu" hidden="">
    
    <div class="devsite-tabs-dropdown-content">
      
        <div class="devsite-tabs-dropdown-column
                    ">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/resources/models-datasets" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/resources/models-datasets" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Models &amp; datasets
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Pre-trained models and datasets built by Google and the community
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/resources/tools" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/resources/tools" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Tools
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Ecosystem of tools to help you use TensorFlow
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/resources/libraries-extensions" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/resources/libraries-extensions" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Libraries &amp; extensions
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Libraries and extensions built on TensorFlow
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/certificate" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/certificate" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      TensorFlow Certificate program
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Differentiate yourself by demonstrating your ML proficiency
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/resources/learn-ml" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/resources/learn-ml" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Learn ML
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Educational resources to learn the fundamentals of ML with TensorFlow
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/responsible_ai" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/responsible_ai" track-metadata-position="nav - resources" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Responsible AI
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Resources and tools to integrate Responsible AI practices into your ML workflow
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
    </div>
  </div>
</tab>
        
      
        
          <tab dropdown="">
  
    <a href="https://www.tensorflow.org/community" track-metadata-eventdetail="https://www.tensorflow.org/community" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - community" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Community" track-name="community">
    Community
  
    </a>
  
  
    <a href="https://www.tensorflow.org/text/tutorials/text_generation#" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Dropdown menu for Community" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/community" track-metadata-position="nav - community" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Community" track-name="community" class="devsite-tabs-dropdown-toggle devsite-icon devsite-icon-arrow-drop-down"></a>
  
  <div class="devsite-tabs-dropdown" aria-label="submenu" hidden="">
    
    <div class="devsite-tabs-dropdown-content">
      
        <div class="devsite-tabs-dropdown-column
                    ">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/community" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/community" track-metadata-position="nav - community" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Join
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Explore ways to get involved
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://blog.tensorflow.org/" track-type="nav" track-metadata-eventdetail="https://blog.tensorflow.org/" track-metadata-position="nav - community" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Blog
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Stay up to date with all things TensorFlow
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://discuss.tensorflow.org/" track-type="nav" track-metadata-eventdetail="https://discuss.tensorflow.org" track-metadata-position="nav - community" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Forum ↗
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Discussion platform for the TensorFlow community
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/community/groups" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/community/groups" track-metadata-position="nav - community" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Groups
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      User groups, interest groups and mailing lists
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/community/contribute" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/community/contribute" track-metadata-position="nav - community" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Contribute
                    </div>
                    
                    <div class="devsite-nav-item-description">
                      Guide for contributing to code and documentation
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
    </div>
  </div>
</tab>
        
      
        
          
        
      
    <tab overflow-tab=""><a aria-label="Extended Navigation" href="https://www.tensorflow.org/text/tutorials/text_generation#" class="devsite-icon devsite-icon-arrow-drop-down">More</a><div class="devsite-tabs-overflow-menu" scrollbars="" hidden=""><tab dropdown="">
  
    <a href="https://www.tensorflow.org/about" track-metadata-eventdetail="https://www.tensorflow.org/about" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - why tensorflow" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Why TensorFlow" track-name="why tensorflow">
    Why TensorFlow
  
    </a>
  
  
    <a href="https://www.tensorflow.org/text/tutorials/text_generation#" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Dropdown menu for Why TensorFlow" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/about" track-metadata-position="nav - why tensorflow" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Why TensorFlow" track-name="why tensorflow" class="devsite-tabs-dropdown-toggle devsite-icon devsite-icon-arrow-drop-down"></a>
  
  <div class="devsite-tabs-dropdown" aria-label="submenu" hidden="">
    
    <div class="devsite-tabs-dropdown-content">
      
        <div class="devsite-tabs-dropdown-column
                    ">
          
            <ul class="devsite-tabs-dropdown-section
                       ">
              
              
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/about" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/about" track-metadata-position="nav - why tensorflow" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      About
                    </div>
                    
                  </a>
                </li>
              
                <li class="devsite-nav-item">
                  <a href="https://www.tensorflow.org/about/case-studies" track-type="nav" track-metadata-eventdetail="https://www.tensorflow.org/about/case-studies" track-metadata-position="nav - why tensorflow" track-metadata-module="tertiary nav" tooltip="">
                    
                    <div class="devsite-nav-item-title">
                      Case studies
                    </div>
                    
                  </a>
                </li>
              
            </ul>
          
        </div>
      
    </div>
  </div>
</tab></div></tab></nav></devsite-tabs>

            
           </div>
          
<devsite-search enable-signin="" enable-search="" enable-suggestions="" enable-query-completion="" project-name="Text" tenant-name="TensorFlow">
  <form class="devsite-search-form" action="https://www.tensorflow.org/s/results" method="GET">
    <div class="devsite-search-container">
      <button type="button" search-open="" class="devsite-search-button devsite-header-icon-button button-flat material-icons" aria-label="Open search"></button>
      <div class="devsite-searchbox">
        <input aria-activedescendant="" aria-autocomplete="list" aria-label="Search" aria-expanded="false" aria-haspopup="listbox" autocomplete="off" class="devsite-search-field devsite-search-query" name="q" placeholder="Search" role="combobox" type="text" value="" aria-controls="devsite-search-popout-container-id-1">
          <div class="devsite-search-image material-icons" aria-hidden="true">
            
          </div>
      </div>
    </div>
  <div class="devsite-popout" id="devsite-search-popout-container-id-1"><div class="devsite-popout-result devsite-suggest-results-container" devsite-hide=""></div></div></form>
  <button type="button" search-close="" class="devsite-search-button devsite-header-icon-button button-flat material-icons" aria-label="Close search"></button>
</devsite-search>

        <div class="devsite-search-background" style="opacity: 1;"></div></div>

        

        

        

        
<devsite-language-selector aria-label="Select your language preference."><template shadowrootmode="open"><!---->
      <button type="button" aria-controls="language-menu" aria-haspopup="true">
        <svg aria-hidden="true" class="icon-language" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 22q-2.05 0-3.875-.788-1.825-.787-3.187-2.15-1.363-1.362-2.15-3.187Q2 14.05 2 12q0-2.075.788-3.887.787-1.813 2.15-3.175Q6.3 3.575 8.125 2.787 9.95 2 12 2q2.075 0 3.887.787 1.813.788 3.175 2.151 1.363 1.362 2.15 3.175Q22 9.925 22 12q0 2.05-.788 3.875-.787 1.825-2.15 3.187-1.362 1.363-3.175 2.15Q14.075 22 12 22Zm0-2.05q.65-.9 1.125-1.875T13.9 16h-3.8q.3 1.1.775 2.075.475.975 1.125 1.875Zm-2.6-.4q-.45-.825-.787-1.713Q8.275 16.95 8.05 16H5.1q.725 1.25 1.812 2.175Q8 19.1 9.4 19.55Zm5.2 0q1.4-.45 2.487-1.375Q18.175 17.25 18.9 16h-2.95q-.225.95-.562 1.837-.338.888-.788 1.713ZM4.25 14h3.4q-.075-.5-.113-.988Q7.5 12.525 7.5 12t.037-1.012q.038-.488.113-.988h-3.4q-.125.5-.188.988Q4 11.475 4 12t.062 1.012q.063.488.188.988Zm5.4 0h4.7q.075-.5.113-.988.037-.487.037-1.012t-.037-1.012q-.038-.488-.113-.988h-4.7q-.075.5-.112.988Q9.5 11.475 9.5 12t.038 1.012q.037.488.112.988Zm6.7 0h3.4q.125-.5.188-.988Q20 12.525 20 12t-.062-1.012q-.063-.488-.188-.988h-3.4q.075.5.112.988.038.487.038 1.012t-.038 1.012q-.037.488-.112.988Zm-.4-6h2.95q-.725-1.25-1.813-2.175Q16 4.9 14.6 4.45q.45.825.788 1.712.337.888.562 1.838ZM10.1 8h3.8q-.3-1.1-.775-2.075Q12.65 4.95 12 4.05q-.65.9-1.125 1.875T10.1 8Zm-5 0h2.95q.225-.95.563-1.838.337-.887.787-1.712Q8 4.9 6.912 5.825 5.825 6.75 5.1 8Z"></path>
        </svg>
        <span class="label"><!--?lit$127407053$-->English</span>
        <svg aria-hidden="true" class="icon-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m12 15-5-5h10Z"></path>
        </svg>
      </button>
      <div id="language-menu" role="menu" hidden="">
        <slot></slot>
      </div></template>
  <ul role="presentation">
    
    
    <li role="presentation">
      <a role="menuitem" lang="en" aria-current="true" href="https://www.tensorflow.org/text/tutorials/text_generation">English</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="es-419" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=es-419">Español – América Latina</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fr">Français</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="id" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=id">Indonesia</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="it" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=it">Italiano</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pl" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pl">Polski</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pt-br" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pt-br">Português – Brasil</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="vi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=vi">Tiếng Việt</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="tr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=tr">Türkçe</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ru" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ru">Русский</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="he" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=he">עברית</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ar" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ar">العربيّة</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fa" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fa">فارسی</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="hi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=hi">हिंदी</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="bn" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=bn">বাংলা</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="th" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=th">ภาษาไทย</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="zh-cn" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=zh-cn">中文 – 简体</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ja" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ja">日本語</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ko" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ko">한국어</a>
    </li>
    
  </ul>
</devsite-language-selector>


        
          
  <a class="devsite-header-link devsite-top-button button gc-analytics-event" href="https://github.com/tensorflow" data-category="Site-Wide Custom Events" data-label="Site header link">
    GitHub
  </a>
  
        

        
          
          
          <devsite-user enable-profiles="" id="devsite-user" sign-in-url="https://www.tensorflow.org/_d/signin?continue=https%3A%2F%2Fwww.tensorflow.org%2Ftext%2Ftutorials%2Ftext_generation&amp;prompt=select_account" sign-out-url="https://www.tensorflow.org/_d/signout?continue=https%3A%2F%2Fwww.tensorflow.org%2Ftext%2Ftutorials%2Ftext_generation" url="https://www.tensorflow.org/_d/signout?continue=https%3A%2F%2Fwww.tensorflow.org%2Ftext%2Ftutorials%2Ftext_generation"><div class="ogb-wrapper ogb-si"><a href="https://www.tensorflow.org/_d/signin?continue=https%3A%2F%2Fwww.tensorflow.org%2Ftext%2Ftutorials%2Ftext_generation&amp;prompt=select_account" id="devsite-signin-btn" class="devsite-user-signin button devsite-top-button" track-type="globalNav" track-name="signIn" track-metadata-eventdetail="nav" track-metadata-position="nav">
  Sign in
</a></div></devsite-user>
           
        
      </div>
    </div>
  </div>



  <div class="devsite-collapsible-section
    " style="transform: translate3d(0px, -60px, 0px);">
    <div class="devsite-header-background">
      
        
          <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
              
                
                  
                  
                  <ul class="devsite-breadcrumb-list">
  
  <li class="devsite-breadcrumb-item
             ">
    
    
    
      
  <a href="https://www.tensorflow.org/text" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Lower Header" data-value="1" track-type="globalNav" track-name="breadcrumb" track-metadata-position="1" track-metadata-eventdetail="Text">
    
        Text
      
  </a>
  
    
  </li>
  
</ul>
                
              
              
            </div>
            
          </div>
          
        
      
      
        <div class="devsite-doc-set-nav-row">
          
          
            
            
  <devsite-tabs class="lower-tabs" connected="">

    

  <nav class="devsite-tabs-wrapper" aria-label="Lower tabs">
      
        
          <tab>
            
    <a href="https://www.tensorflow.org/text" track-metadata-eventdetail="https://www.tensorflow.org/text" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - overview" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Overview" track-name="overview">
    Overview
  
    </a>
  
  
          </tab>
        
      
        
          <tab active="">
            
    <a href="https://www.tensorflow.org/text/tutorials" track-metadata-eventdetail="https://www.tensorflow.org/text/tutorials" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - tutorials" track-metadata-module="primary nav" aria-label="Tutorials, selected" data-category="Site-Wide Custom Events" data-label="Tab: Tutorials" track-name="tutorials">
    Tutorials
  
    </a>
  
  
          </tab>
        
      
        
          <tab>
            
    <a href="https://www.tensorflow.org/text/guide" track-metadata-eventdetail="https://www.tensorflow.org/text/guide" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - guide" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: Guide" track-name="guide">
    Guide
  
    </a>
  
  
          </tab>
        
      
        
          <tab>
            
    <a href="https://www.tensorflow.org/text/api_overview" track-metadata-eventdetail="https://www.tensorflow.org/text/api_overview" class="devsite-tabs-content gc-analytics-event " track-type="nav" track-metadata-position="nav - api" track-metadata-module="primary nav" data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api">
    API
  
    </a>
  
  
          </tab>
        
      
    <tab overflow-tab="" hidden=""><a aria-label="More Options" href="https://www.tensorflow.org/text/tutorials/text_generation#" class="devsite-icon devsite-icon-arrow-drop-down">More</a><div class="devsite-tabs-overflow-menu" scrollbars="" hidden=""></div></tab></nav></devsite-tabs>

          
          
        </div>
      
    </div>
  </div>

</div>



  

  
</devsite-header>
      <div class="devsite-book-nav-bg" fixed=""></div><devsite-book-nav scrollbars="" fixed="" style="top: 157px; max-height: 523px; --devsite-js-book-nav-y-offset: -60px;" user-scrolled="">
        
          





















<div class="devsite-book-nav-filter
            ">
  <span class="filter-list-icon material-icons" aria-hidden="true"></span>
  <input type="text" placeholder="Filter" aria-label="Type to filter" role="searchbox">
  
  <span class="filter-clear-button hidden" data-title="Clear filter" aria-label="Clear filter" role="button" tabindex="0"></span>
</div>

<nav class="devsite-book-nav devsite-nav nocontent" aria-label="Side menu">
  <div class="devsite-mobile-header">
    <button type="button" id="devsite-close-nav" class="devsite-header-icon-button button-flat material-icons gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Close navigation" aria-label="Close navigation">
    </button>
    <div class="devsite-product-name-wrapper">

  <a href="https://www.tensorflow.org/" class="devsite-site-logo-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Site logo" track-type="globalNav" track-name="tensorFlow" track-metadata-position="nav" track-metadata-eventdetail="nav">

  
    <img src="./Text generation with an RNN  _  TensorFlow_files/lockup.svg" class="devsite-site-logo" alt="TensorFlow">
  

</a>


  
      <span class="devsite-product-name">
        
        
        <ul class="devsite-breadcrumb-list">
  
  <li class="devsite-breadcrumb-item
             ">
    
    
    
      
      
    
  </li>
  
</ul>
      </span>
    

</div>
  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
      
        <ul class="devsite-nav-list">
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/install" class="devsite-nav-title gc-analytics-event
              devsite-nav-has-children
              " data-category="Site-Wide Custom Events" data-label="Tab: Install" track-name="install" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Install
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward">
    </span>
    
  
  </a>
  

  
              
            </li>
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/learn" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Tab: Learn" track-name="learn" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Learn
   </span>
    
  
  </a>
  

  
    <ul class="devsite-nav-responsive-tabs devsite-nav-has-menu
               ">
      
<li class="devsite-nav-item">

  
  <span class="devsite-nav-title" tooltip="" data-category="Site-Wide Custom Events" data-label="Tab: Learn" track-name="learn">
  
    <span class="devsite-nav-text" tooltip="" menu="Learn">
      More
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="Learn">
    </span>
    
  
  </span>
  

</li>

    </ul>
  
              
            </li>
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/api" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      API
   </span>
    
  
  </a>
  

  
    <ul class="devsite-nav-responsive-tabs devsite-nav-has-menu
               ">
      
<li class="devsite-nav-item">

  
  <span class="devsite-nav-title" tooltip="" data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api">
  
    <span class="devsite-nav-text" tooltip="" menu="API">
      More
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="API">
    </span>
    
  
  </span>
  

</li>

    </ul>
  
              
            </li>
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/resources" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Tab: Resources" track-name="resources" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Resources
   </span>
    
  
  </a>
  

  
    <ul class="devsite-nav-responsive-tabs devsite-nav-has-menu
               ">
      
<li class="devsite-nav-item">

  
  <span class="devsite-nav-title" tooltip="" data-category="Site-Wide Custom Events" data-label="Tab: Resources" track-name="resources">
  
    <span class="devsite-nav-text" tooltip="" menu="Resources">
      More
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="Resources">
    </span>
    
  
  </span>
  

</li>

    </ul>
  
              
                <ul class="devsite-nav-responsive-tabs">
                  
                    
                    
                    
                    <li class="devsite-nav-item">
                      
  
  <a href="https://www.tensorflow.org/text" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Tab: Overview" track-name="overview" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Overview
   </span>
    
  
  </a>
  

  
                    </li>
                  
                    
                    
                    
                    <li class="devsite-nav-item">
                      
  
  <a href="https://www.tensorflow.org/text/tutorials" class="devsite-nav-title gc-analytics-event devsite-nav-has-children" data-category="Site-Wide Custom Events" data-label="Tab: Tutorials" track-name="tutorials" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="" menu="_book">
      Tutorials
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="_book">
    </span>
    
  
  </a>
  

  
                    </li>
                  
                    
                    
                    
                    <li class="devsite-nav-item">
                      
  
  <a href="https://www.tensorflow.org/text/guide" class="devsite-nav-title gc-analytics-event
              devsite-nav-has-children
              " data-category="Site-Wide Custom Events" data-label="Tab: Guide" track-name="guide" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Guide
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward">
    </span>
    
  
  </a>
  

  
                    </li>
                  
                    
                    
                    
                    <li class="devsite-nav-item">
                      
  
  <a href="https://www.tensorflow.org/text/api_overview" class="devsite-nav-title gc-analytics-event
              devsite-nav-has-children
              " data-category="Site-Wide Custom Events" data-label="Tab: API" track-name="api" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      API
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward">
    </span>
    
  
  </a>
  

  
                    </li>
                  
                </ul>
              
            </li>
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/community" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Tab: Community" track-name="community" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Community
   </span>
    
  
  </a>
  

  
    <ul class="devsite-nav-responsive-tabs devsite-nav-has-menu
               ">
      
<li class="devsite-nav-item">

  
  <span class="devsite-nav-title" tooltip="" data-category="Site-Wide Custom Events" data-label="Tab: Community" track-name="community">
  
    <span class="devsite-nav-text" tooltip="" menu="Community">
      More
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="Community">
    </span>
    
  
  </span>
  

</li>

    </ul>
  
              
            </li>
          
            <li class="devsite-nav-item">
              
  
  <a href="https://www.tensorflow.org/about" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Tab: Why TensorFlow" track-name="why tensorflow" track-type="globalNav" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Why TensorFlow
   </span>
    
  
  </a>
  

  
    <ul class="devsite-nav-responsive-tabs devsite-nav-has-menu
               ">
      
<li class="devsite-nav-item">

  
  <span class="devsite-nav-title" tooltip="" data-category="Site-Wide Custom Events" data-label="Tab: Why TensorFlow" track-name="why tensorflow">
  
    <span class="devsite-nav-text" tooltip="" menu="Why TensorFlow">
      More
   </span>
    
    <span class="devsite-nav-icon material-icons" data-icon="forward" menu="Why TensorFlow">
    </span>
    
  
  </span>
  

</li>

    </ul>
  
              
            </li>
          
          
    
<li class="devsite-nav-item">

  
  <a href="https://github.com/tensorflow" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: GitHub" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      GitHub
   </span>
    
  
  </a>
  

</li>

  
          
        </ul>
      
    </div>
    
      <div class="devsite-mobile-nav-bottom">
        
          
          <ul class="devsite-nav-list" menu="_book">
            <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials"><span class="devsite-nav-text" tooltip="">Overview</span></a></li>

  <li class="devsite-nav-item
           devsite-nav-divider
           devsite-nav-heading"><div class="devsite-nav-title devsite-nav-title-no-path">
        <span class="devsite-nav-text" tooltip="">Keras NLP</span>
      </div></li>

  <li class="devsite-nav-item
           devsite-nav-external"><a href="https://keras.io/guides/keras_nlp/getting_started/" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: https://keras.io/guides/keras_nlp/getting_started/" track-type="bookNav" track-name="click" track-metadata-eventdetail="https://keras.io/guides/keras_nlp/getting_started/"><span class="devsite-nav-text" tooltip="">Get started with KerasNLP</span><span class="devsite-nav-icon material-icons" data-icon="external" data-title="External" aria-hidden="true"></span></a></li>

  <li class="devsite-nav-item
           devsite-nav-divider
           devsite-nav-heading"><div class="devsite-nav-title devsite-nav-title-no-path">
        <span class="devsite-nav-text" tooltip="">Text Generation</span>
      </div></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation" class="devsite-nav-title gc-analytics-event devsite-nav-active" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/text_generation" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/text_generation"><span class="devsite-nav-text" tooltip="">Generate Text with RNNs</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/nmt_with_attention" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/nmt_with_attention" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/nmt_with_attention"><span class="devsite-nav-text" tooltip="">Translate text with seq2seq models</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/transformer" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/transformer" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/transformer"><span class="devsite-nav-text" tooltip="">Translate text with transformer models</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/image_captioning" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/image_captioning" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/image_captioning"><span class="devsite-nav-text" tooltip="">Image captioning</span></a></li>

  <li class="devsite-nav-item
           devsite-nav-divider
           devsite-nav-heading"><div class="devsite-nav-title devsite-nav-title-no-path">
        <span class="devsite-nav-text" tooltip="">Text Classification</span>
      </div></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/classify_text_with_bert" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/classify_text_with_bert" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/classify_text_with_bert"><span class="devsite-nav-text" tooltip="">Text classification with BERT</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_classification_rnn" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/text_classification_rnn" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/text_classification_rnn"><span class="devsite-nav-text" tooltip="">Text classification with RNNs</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_similarity" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/text_similarity" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/text_similarity"><span class="devsite-nav-text" tooltip="">Compute Similarity Metrics</span></a></li>

  <li class="devsite-nav-item
           devsite-nav-divider
           devsite-nav-heading"><div class="devsite-nav-title devsite-nav-title-no-path">
        <span class="devsite-nav-text" tooltip="">NLP with BERT</span>
      </div></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/bert_glue" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/bert_glue" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/bert_glue"><span class="devsite-nav-text" tooltip="">Fine Tune Bert on GLUE tasks</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/tfmodels/nlp/fine_tune_bert" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /tfmodels/nlp/fine_tune_bert" track-type="bookNav" track-name="click" track-metadata-eventdetail="/tfmodels/nlp/fine_tune_bert"><span class="devsite-nav-text" tooltip="">Fine tune BERT</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/uncertainty_quantification_with_sngp_bert" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/uncertainty_quantification_with_sngp_bert" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/uncertainty_quantification_with_sngp_bert"><span class="devsite-nav-text" tooltip="">Quantify uncertainty with BERT</span></a></li>

  <li class="devsite-nav-item
           devsite-nav-divider
           devsite-nav-heading"><div class="devsite-nav-title devsite-nav-title-no-path">
        <span class="devsite-nav-text" tooltip="">Embeddings</span>
      </div></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/word_embeddings" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/word_embeddings" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/word_embeddings"><span class="devsite-nav-text" tooltip="">Word embeddings</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/warmstart_embedding_matrix" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/warmstart_embedding_matrix" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/warmstart_embedding_matrix"><span class="devsite-nav-text" tooltip="">Warmstarting embeddings</span></a></li>

  <li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/word2vec" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Book nav link, pathname: /text/tutorials/word2vec" track-type="bookNav" track-name="click" track-metadata-eventdetail="/text/tutorials/word2vec"><span class="devsite-nav-text" tooltip="">Word2Vec</span></a></li>
          </ul>
        
        
          
    
  
    
      
      <ul class="devsite-nav-list" menu="Learn" aria-label="Side menu" hidden="">
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/learn" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Introduction" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Introduction
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/overview" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TensorFlow" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TensorFlow
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/js" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: For JavaScript" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      For JavaScript
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/lite" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: For Mobile &amp; Edge" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      For Mobile &amp; Edge
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/tfx" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: For Production" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      For Production
   </span>
    
  
  </a>
  

</li>

            
          
        
      </ul>
    
  
    
      
      <ul class="devsite-nav-list" menu="API" aria-label="Side menu" hidden="">
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/api/stable" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TensorFlow (v2.14.0)" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TensorFlow (v2.14.0)
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/versions" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Versions…" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Versions…
   </span>
    
  
  </a>
  

</li>

            
          
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://js.tensorflow.org/api/latest/" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TensorFlow.js" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TensorFlow.js
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/lite/api_docs" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TensorFlow Lite" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TensorFlow Lite
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/tfx/api_docs" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TFX" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TFX
   </span>
    
  
  </a>
  

</li>

            
          
        
      </ul>
    
  
    
      
      <ul class="devsite-nav-list" menu="Resources" aria-label="Side menu" hidden="">
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/resources/models-datasets" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Models &amp; datasets" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Models &amp; datasets
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/resources/tools" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Tools" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Tools
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/resources/libraries-extensions" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Libraries &amp; extensions" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Libraries &amp; extensions
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/certificate" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: TensorFlow Certificate program" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      TensorFlow Certificate program
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/resources/learn-ml" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Learn ML" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Learn ML
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/responsible_ai" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Responsible AI" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Responsible AI
   </span>
    
  
  </a>
  

</li>

            
          
        
      </ul>
    
  
    
      
      <ul class="devsite-nav-list" menu="Community" aria-label="Side menu" hidden="">
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/community" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Join" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Join
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://blog.tensorflow.org/" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Blog" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Blog
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://discuss.tensorflow.org/" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Forum ↗" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Forum ↗
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/community/groups" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Groups" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Groups
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/community/contribute" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Contribute" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Contribute
   </span>
    
  
  </a>
  

</li>

            
          
        
      </ul>
    
  
    
      
      <ul class="devsite-nav-list" menu="Why TensorFlow" aria-label="Side menu" hidden="">
        
          
            
            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/about" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: About" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      About
   </span>
    
  
  </a>
  

</li>

            
              
<li class="devsite-nav-item">

  
  <a href="https://www.tensorflow.org/about/case-studies" class="devsite-nav-title gc-analytics-event
              
              " data-category="Site-Wide Custom Events" data-label="Responsive Tab: Case studies" track-type="navMenu" track-metadata-eventdetail="globalMenu" track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip="">
      Case studies
   </span>
    
  
  </a>
  

</li>

            
          
        
      </ul>
    
  
        
        
          
    
  
    
  
    
  
    
  
        
      </div>
    
  </div>
</nav>
        
      </devsite-book-nav><div class="devsite-book-nav-blur" fixed="" style="--devsite-js-book-nav-scrollbar-width: 8px;"></div><button class="devsite-book-nav-toggle" aria-haspopup="menu" fixed="" aria-label="Hide side navigation" data-title="Hide side navigation" aria-expanded="true"><span class="material-icons devsite-book-nav-toggle-icon"></span></button>
      <section id="gc-wrapper" style="margin-top: 157px;">
        <main role="main" class="devsite-main-content" has-book-nav="" has-sidebar="">
          
          
          <div class="devsite-sidebar" fixed="" style="--devsite-js-sidebar-max-height: 475px; --devsite-js-sidebar-max-width: 144px; --devsite-js-sidebar-offset: -60px;">
            <div class="devsite-sidebar-content">
                
                <devsite-toc class="devsite-nav devsite-toc" role="navigation" aria-label="On this page" depth="2" scrollbars="" visible=""><ul class="devsite-nav-list"><li class="devsite-nav-item devsite-nav-heading devsite-toc-toggle"><span class="devsite-nav-title" role="heading" aria-level="2"><span class="devsite-nav-text">On this page</span></span></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#setup" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="0" track-type="navigation" track-name="rightNav" track-metadata-position="0" track-metadata-link-destination="#setup"><span class="devsite-nav-text" tooltip="">Setup</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#import_tensorflow_and_other_libraries" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="0.0" track-type="navigation" track-name="rightNav" track-metadata-position="0.0" track-metadata-link-destination="#import_tensorflow_and_other_libraries"><span class="devsite-nav-text" tooltip="">Import TensorFlow and other libraries</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#download_the_shakespeare_dataset" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="0.1" track-type="navigation" track-name="rightNav" track-metadata-position="0.1" track-metadata-link-destination="#download_the_shakespeare_dataset"><span class="devsite-nav-text" tooltip="">Download the Shakespeare dataset</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#read_the_data" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="0.2" track-type="navigation" track-name="rightNav" track-metadata-position="0.2" track-metadata-link-destination="#read_the_data"><span class="devsite-nav-text" tooltip="">Read the data</span></a></li></ul></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#process_the_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="1" track-type="navigation" track-name="rightNav" track-metadata-position="1" track-metadata-link-destination="#process_the_text"><span class="devsite-nav-text" tooltip="">Process the text</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#vectorize_the_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="1.0" track-type="navigation" track-name="rightNav" track-metadata-position="1.0" track-metadata-link-destination="#vectorize_the_text"><span class="devsite-nav-text" tooltip="">Vectorize the text</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#the_prediction_task" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="1.1" track-type="navigation" track-name="rightNav" track-metadata-position="1.1" track-metadata-link-destination="#the_prediction_task"><span class="devsite-nav-text" tooltip="">The prediction task</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#create_training_examples_and_targets" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="1.2" track-type="navigation" track-name="rightNav" track-metadata-position="1.2" track-metadata-link-destination="#create_training_examples_and_targets"><span class="devsite-nav-text" tooltip="">Create training examples and targets</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#create_training_batches" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="1.3" track-type="navigation" track-name="rightNav" track-metadata-position="1.3" track-metadata-link-destination="#create_training_batches"><span class="devsite-nav-text" tooltip="">Create training batches</span></a></li></ul></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#build_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="2" track-type="navigation" track-name="rightNav" track-metadata-position="2" track-metadata-link-destination="#build_the_model"><span class="devsite-nav-text" tooltip="">Build The Model</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#try_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="3" track-type="navigation" track-name="rightNav" track-metadata-position="3" track-metadata-link-destination="#try_the_model"><span class="devsite-nav-text" tooltip="">Try the model</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#train_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="4" track-type="navigation" track-name="rightNav" track-metadata-position="4" track-metadata-link-destination="#train_the_model"><span class="devsite-nav-text" tooltip="">Train the model</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#attach_an_optimizer_and_a_loss_function" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="4.0" track-type="navigation" track-name="rightNav" track-metadata-position="4.0" track-metadata-link-destination="#attach_an_optimizer_and_a_loss_function"><span class="devsite-nav-text" tooltip="">Attach an optimizer, and a loss function</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#configure_checkpoints" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="4.1" track-type="navigation" track-name="rightNav" track-metadata-position="4.1" track-metadata-link-destination="#configure_checkpoints"><span class="devsite-nav-text" tooltip="">Configure checkpoints</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#execute_the_training" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="4.2" track-type="navigation" track-name="rightNav" track-metadata-position="4.2" track-metadata-link-destination="#execute_the_training"><span class="devsite-nav-text" tooltip="">Execute the training</span></a></li></ul></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#generate_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="5" track-type="navigation" track-name="rightNav" track-metadata-position="5" track-metadata-link-destination="#generate_text"><span class="devsite-nav-text" tooltip="">Generate text</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#export_the_generator" class="devsite-nav-title gc-analytics-event devsite-nav-active" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="6" track-type="navigation" track-name="rightNav" track-metadata-position="6" track-metadata-link-destination="#export_the_generator"><span class="devsite-nav-text" tooltip="">Export the generator</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#advanced_customized_training" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Right nav" data-value="7" track-type="navigation" track-name="rightNav" track-metadata-position="7" track-metadata-link-destination="#advanced_customized_training"><span class="devsite-nav-text" tooltip="">Advanced: Customized Training</span></a></li></ul></devsite-toc>
                <devsite-recommendations-sidebar class="nocontent devsite-nav">
                </devsite-recommendations-sidebar>
            </div>
          </div>
          
          <devsite-content>
            
              











<article class="devsite-article" has-bookmark=""><style>
      /* Styles inlined from /site-assets/css/style.css */
/* override theme */
table img {
  max-width: 100%;
}

/* .devsite-terminal virtualenv prompt */
.tfo-terminal-venv::before {
  content: "(venv) $ " !important;
}

/* .devsite-terminal root prompt */
.tfo-terminal-root::before {
  content: "# " !important;
}

/* Used in links for type annotations in function/method signatures */
.tfo-signature-link a,
.tfo-signature-link a:visited,
.tfo-signature-link a:hover,
.tfo-signature-link a:focus,
.tfo-signature-link a:hover *,
.tfo-signature-link a:focus * {
  text-decoration: none !important;
}

.tfo-signature-link a,
.tfo-signature-link a:visited {
  border-bottom: 1px dotted #1a73e8;
}

.tfo-signature-link a:focus {
  border-bottom-style: solid;
}

/* .devsite-terminal Windows prompt */
.tfo-terminal-windows::before {
  content: "C:\\> " !important;
}

/* .devsite-terminal Windows prompt w/ virtualenv */
.tfo-terminal-windows-venv::before {
  content: "(venv) C:\\> " !important;
}

.tfo-diff-green-one-level + * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green + * > * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green-list + ul > li:first-of-type {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-red-one-level + * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red + * > * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red-list + ul > li:first-of-type {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

devsite-code .tfo-notebook-code-cell-output {
  max-height: 300px;
  overflow: auto;
  background: rgba(255, 247, 237, 1);  /* orange bg to distinguish from input code cells */
}

devsite-code .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(255, 247, 237, .7);  /* orange bg to distinguish from input code cells */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output {
  background: rgba(64, 78, 103, 1);  /* medium slate */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(64, 78, 103, .7);  /* medium slate */
}

/* override default table styles for notebook buttons */
.devsite-table-wrapper .tfo-notebook-buttons {
  display: inline-block;
  margin-left: 3px;
  width: auto;
}

.tfo-notebook-buttons td {
  padding-left: 0;
  padding-right: 20px;
}

.tfo-notebook-buttons a,
.tfo-notebook-buttons :link,
.tfo-notebook-buttons :visited {
  border-radius: 8px;
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15);
  color: #202124;
  padding: 12px 17px;
  transition: box-shadow 0.2s;
}

.tfo-notebook-buttons a:hover,
.tfo-notebook-buttons a:focus {
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 2px 6px 2px rgba(60, 64, 67, .15);
}

.tfo-notebook-buttons tr {
  background: 0;
  border: 0;
}

/* on rendered notebook page,
   remove link to webpage since we're already here */
.tfo-notebook-buttons:not(.tfo-api) td:first-child {
  display: none;
}

.tfo-notebook-buttons td > a {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.tfo-notebook-buttons td > a > img {
  margin-right: 8px;
}

/* landing pages */

.tfo-landing-row-item-inset-white {
  background-color: #fff;
  padding: 32px;
}

.tfo-landing-row-item-inset-white ol,
.tfo-landing-row-item-inset-white ul {
  padding-left: 20px;
}

/* colab callout button */
.colab-callout-row devsite-code {
  border-radius: 8px 8px 0 0;
  box-shadow: none;
}

.colab-callout-footer {
  background: #e3e4e7;
  border-radius: 0 0 8px 8px;
  color: #37474f;
  padding: 20px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer {
  background: #3f4f66;
}


.colab-callout-footer > .button {
  margin-top: 4px;
  color: #ff5c00;
}

.colab-callout-footer > a > span {
  padding-top: 10px;
  vertical-align: middle;
  color: #37474f;
  padding-left: 10px;
  padding-right: 10px;
  font-size: 14px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer > a > span {
  color: #fff;
}

a.colab-button {
  background: rgba(255, 255, 255, .75);
  border: solid 1px rgba(0, 0, 0, .08);
  border-bottom-color: rgba(0, 0, 0, .15);
  border-radius: 4px;
  color: #aaa;
  display: inline-block;
  font-size: 11px !important;
  font-weight: 300;
  line-height: 16px;
  padding: 4px 8px;
  text-decoration: none;
  text-transform: uppercase;
}

a.colab-button:hover {
  background: white;
  border-color: rgba(0, 0, 0, .2);
  color: #666;
}

a.colab-button span {
  background: url(/images/colab_logo_button.svg) no-repeat 1px 1px / 20px;
  border-radius: 4px;
  display: inline-block;
  padding-left: 24px;
  text-decoration: none;
}

@media screen and (max-width: 600px) {
  .tfo-notebook-buttons td {
    display: block;
  }
}

/* guide and tutorials landing page cards and sections */

.tfo-landing-page-card {
  padding: 16px;
  box-shadow: 0 0 36px rgba(0,0,0,0.1);
  border-radius: 10px;
}

/* Page section headings */
.tfo-landing-page-heading h2, h2.tfo-landing-page-heading {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 30px;
  font-weight: 700;
  line-height: 40px;
}

/* Item title headings */
.tfo-landing-page-heading h3, h3.tfo-landing-page-heading,
.tfo-landing-page-card h3, h3.tfo-landing-page-card {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 20px;
  font-weight: 500;
  line-height: 26px;
}

/* List of tutorials notebooks for subsites */
.tfo-landing-page-resources-ul {
  padding-left: 15px
}

.tfo-landing-page-resources-ul > li {
  margin: 6px 0;
}

/* Temporary fix to hide product description in header on landing pages */
devsite-header .devsite-product-description {
  display: none;
}

      </style>
  
  
    <div class="devsite-banner devsite-banner-announcement nocontent">
      <div class="devsite-banner-message">
        <div class="devsite-banner-message-text">
          Try out Gemini’s text and image reasoning capabilities in Google AI Studio—it’s fast and free <a class="button button-primary button-tfo-announcement" href="https://ai.google.dev/?utm_source=tensorflow&amp;utm_medium=referral" target="_blank" rel="noopener noreferrer" item-id="gemini">Build with Gemini</a>

        </div>
      </div>
    </div>
  
  
  

  <div class="devsite-article-meta nocontent" role="navigation">
    
    
    <ul class="devsite-breadcrumb-list" aria-label="Breadcrumb">
  
  <li class="devsite-breadcrumb-item
             ">
    
    
    
      
  <a href="https://www.tensorflow.org/" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1" track-type="globalNav" track-name="breadcrumb" track-metadata-position="1" track-metadata-eventdetail="TensorFlow">
    
        TensorFlow
      
  </a>
  
    
  </li>
  
  <li class="devsite-breadcrumb-item
             ">
    
      
      <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
    
    
    
      
  <a href="https://www.tensorflow.org/resources" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2" track-type="globalNav" track-name="breadcrumb" track-metadata-position="2" track-metadata-eventdetail="">
    
        Resources
      
  </a>
  
    
  </li>
  
  <li class="devsite-breadcrumb-item
             ">
    
      
      <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
    
    
    
      
  <a href="https://www.tensorflow.org/text" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3" track-type="globalNav" track-name="breadcrumb" track-metadata-position="3" track-metadata-eventdetail="Text">
    
        Text
      
  </a>
  
    
  </li>
  
  <li class="devsite-breadcrumb-item
             ">
    
      
      <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
    
    
    
      
  <a href="https://www.tensorflow.org/text/tutorials" class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="4" track-type="globalNav" track-name="breadcrumb" track-metadata-position="4" track-metadata-eventdetail="">
    
        Tutorials
      
  </a>
  
    
  </li>
  
</ul>
    
      
    <devsite-thumb-rating position="header"><div class="devsite-thumb-rating" role="form" aria-labelledby="devsite-thumb-label-header"><div class="devsite-thumb-label" id="devsite-thumb-label-header">Was this helpful?</div><div class="devsite-thumbs"><button class="devsite-thumb devsite-thumb-up" data-title="Helpful" aria-label="Helpful"><svg class="devsite-thumb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21,7h-6.31l0.95-4.57l0.03-0.32c0-0.41-0.17-0.79-0.44-1.06L14.17,0c0,0-7.09,6.85-7.17,7H2v13h16 c0.83,0,1.54-0.5,1.84-1.22l3.02-7.05C22.95,11.5,23,11.26,23,11V9C23,7.9,22.1,7,21,7z M7,18H4V9h3V18z M21,11l-3,7H9V8l4.34-4.34 L12,9h9V11z"></path></svg></button><button class="devsite-thumb devsite-thumb-down" data-title="Not helpful" aria-label="Not helpful"><svg class="devsite-thumb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3,17h6.31l-0.95,4.57l-0.03,0.32c0,0.41,0.17,0.79,0.44,1.06L9.83,24c0,0,7.09-6.85,7.17-7h5V4H6 C5.17,4,4.46,4.5,4.16,5.22l-3.02,7.05C1.05,12.5,1,12.74,1,13v2C1,16.1,1.9,17,3,17z M17,6h3v9h-3V6z M3,13l3-7h9v10l-4.34,4.34 L12,15H3V13z"></path></svg></button></div></div></devsite-thumb-rating>
  
    
  </div>
  <h1 class="devsite-page-title" tabindex="-1">Text generation with an RNN</h1><devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent inline-block" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it" ready="" current-step="0" style="--devsite-popout-offset-x: 32px;"><template shadowrootmode="open"><!---->
      <!--?lit$127407053$-->
      <slot></slot>
      <div class="parent" hidden="">
          <div class="popout">
            <slot name="popout-heading"></slot>
            <slot name="popout-contents"></slot>
            <div class="controls">
              <!--?lit$127407053$-->
              <!--?lit$127407053$-->
                <div class="buttons-container">
                  <!--?lit$127407053$-->
                      <button class="dismiss-button button button-flat">
                        <!--?lit$127407053$-->Dismiss
                      </button>
                  <!--?lit$127407053$-->
                      <!--?lit$127407053$-->
                            <button class="close-button button button-white">
                              <!--?lit$127407053$-->Got it
                            </button>
                    
                </div>
            </div>
          </div>
          <svg class="notch" width="18" height="14" viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
            <path d="M8.15882 1.3085C8.55246 0.696177 9.44754 0.696177 9.84118 1.3085L18 14L0 14L8.15882 1.3085Z"></path>
          </svg>
      </div></template>

        
        <devsite-bookmark class="show"><devsite-dropdown-list ellipsis="" checkboxes="" fetchingitems="true" writable="" additemtext="New Collection" ready="" style="--devsite-popout-offset-x: 0px;"><template shadowrootmode="open"><!---->
        <button class="toggle-button button" aria-haspopup="listbox" id="dropdown-list-0-toggle" aria-controls="dropdown-list-0-dropdown" aria-expanded="false" aria-label="Open dropdown">
          <slot name="toggle"></slot>
        </button>
        <!--?lit$127407053$--><!--?--></template><span class="material-icons bookmark-icon" slot="toggle">bookmark_border</span></devsite-dropdown-list></devsite-bookmark>

        <span slot="popout-heading">
          
          Stay organized with collections
        </span>
        <span slot="popout-contents">
          
          Save and categorize content based on your preferences.
        </span>
      </devsite-feature-tooltip>
    
  <div class="devsite-page-title-meta"></div>
  

  <devsite-toc class="devsite-nav devsite-toc-embedded" depth="2" devsite-toc-embedded="" expandable="" visible=""><ul class="devsite-nav-list"><li class="devsite-nav-item devsite-nav-heading devsite-toc-toggle"><span class="devsite-nav-title" role="heading" aria-level="2"><span class="devsite-nav-text">On this page</span></span><button type="button" title="Expand/collapse contents" class="devsite-nav-show-all button-transparent material-icons"></button></li><li class="devsite-nav-item" visible=""><a href="https://www.tensorflow.org/text/tutorials/text_generation#setup" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="0" track-type="navigation" track-name="embeddedNav" track-metadata-position="0" track-metadata-link-destination="#setup"><span class="devsite-nav-text" tooltip="">Setup</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item" visible=""><a href="https://www.tensorflow.org/text/tutorials/text_generation#import_tensorflow_and_other_libraries" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="0.0" track-type="navigation" track-name="embeddedNav" track-metadata-position="0.0" track-metadata-link-destination="#import_tensorflow_and_other_libraries"><span class="devsite-nav-text" tooltip="">Import TensorFlow and other libraries</span></a></li><li class="devsite-nav-item" visible=""><a href="https://www.tensorflow.org/text/tutorials/text_generation#download_the_shakespeare_dataset" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="0.1" track-type="navigation" track-name="embeddedNav" track-metadata-position="0.1" track-metadata-link-destination="#download_the_shakespeare_dataset"><span class="devsite-nav-text" tooltip="">Download the Shakespeare dataset</span></a></li><li class="devsite-nav-item" visible=""><a href="https://www.tensorflow.org/text/tutorials/text_generation#read_the_data" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="0.2" track-type="navigation" track-name="embeddedNav" track-metadata-position="0.2" track-metadata-link-destination="#read_the_data"><span class="devsite-nav-text" tooltip="">Read the data</span></a></li></ul></li><li class="devsite-nav-item" visible=""><a href="https://www.tensorflow.org/text/tutorials/text_generation#process_the_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="1" track-type="navigation" track-name="embeddedNav" track-metadata-position="1" track-metadata-link-destination="#process_the_text"><span class="devsite-nav-text" tooltip="">Process the text</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#vectorize_the_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="1.0" track-type="navigation" track-name="embeddedNav" track-metadata-position="1.0" track-metadata-link-destination="#vectorize_the_text"><span class="devsite-nav-text" tooltip="">Vectorize the text</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#the_prediction_task" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="1.1" track-type="navigation" track-name="embeddedNav" track-metadata-position="1.1" track-metadata-link-destination="#the_prediction_task"><span class="devsite-nav-text" tooltip="">The prediction task</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#create_training_examples_and_targets" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="1.2" track-type="navigation" track-name="embeddedNav" track-metadata-position="1.2" track-metadata-link-destination="#create_training_examples_and_targets"><span class="devsite-nav-text" tooltip="">Create training examples and targets</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#create_training_batches" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="1.3" track-type="navigation" track-name="embeddedNav" track-metadata-position="1.3" track-metadata-link-destination="#create_training_batches"><span class="devsite-nav-text" tooltip="">Create training batches</span></a></li></ul></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#build_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="2" track-type="navigation" track-name="embeddedNav" track-metadata-position="2" track-metadata-link-destination="#build_the_model"><span class="devsite-nav-text" tooltip="">Build The Model</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#try_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="3" track-type="navigation" track-name="embeddedNav" track-metadata-position="3" track-metadata-link-destination="#try_the_model"><span class="devsite-nav-text" tooltip="">Try the model</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#train_the_model" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="4" track-type="navigation" track-name="embeddedNav" track-metadata-position="4" track-metadata-link-destination="#train_the_model"><span class="devsite-nav-text" tooltip="">Train the model</span></a><ul class="devsite-nav-list"><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#attach_an_optimizer_and_a_loss_function" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="4.0" track-type="navigation" track-name="embeddedNav" track-metadata-position="4.0" track-metadata-link-destination="#attach_an_optimizer_and_a_loss_function"><span class="devsite-nav-text" tooltip="">Attach an optimizer, and a loss function</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#configure_checkpoints" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="4.1" track-type="navigation" track-name="embeddedNav" track-metadata-position="4.1" track-metadata-link-destination="#configure_checkpoints"><span class="devsite-nav-text" tooltip="">Configure checkpoints</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#execute_the_training" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="4.2" track-type="navigation" track-name="embeddedNav" track-metadata-position="4.2" track-metadata-link-destination="#execute_the_training"><span class="devsite-nav-text" tooltip="">Execute the training</span></a></li></ul></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#generate_text" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="5" track-type="navigation" track-name="embeddedNav" track-metadata-position="5" track-metadata-link-destination="#generate_text"><span class="devsite-nav-text" tooltip="">Generate text</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#export_the_generator" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="6" track-type="navigation" track-name="embeddedNav" track-metadata-position="6" track-metadata-link-destination="#export_the_generator"><span class="devsite-nav-text" tooltip="">Export the generator</span></a></li><li class="devsite-nav-item"><a href="https://www.tensorflow.org/text/tutorials/text_generation#advanced_customized_training" class="devsite-nav-title gc-analytics-event" data-category="Site-Wide Custom Events" data-action="click" data-label="Embedded nav" data-value="7" track-type="navigation" track-name="embeddedNav" track-metadata-position="7" track-metadata-link-destination="#advanced_customized_training"><span class="devsite-nav-text" tooltip="">Advanced: Customized Training</span></a></li><li class="devsite-toc-toggle"><button type="button" class="button-flat devsite-nav-more-items material-icons" track-type="navigation" track-name="embeddedNavExpand" title="Expand/collapse contents"></button></li></ul></devsite-toc>
  
    
  

  






<div class="devsite-article-body clearfix
  ">

  
    
<p></p>

<!-- DO NOT EDIT! Automatically generated file. -->



<div class="devsite-table-wrapper"><table class="tfo-notebook-buttons" align="left">
  <tbody><tr><td>
    <a target="_blank" href="https://www.tensorflow.org/text/tutorials/text_generation"><img src="./Text generation with an RNN  _  TensorFlow_files/tf_logo_32px.png">View on TensorFlow.org</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/tensorflow/text/blob/master/docs/tutorials/text_generation.ipynb"><img src="./Text generation with an RNN  _  TensorFlow_files/colab_logo_32px.png">Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/tensorflow/text/blob/master/docs/tutorials/text_generation.ipynb"><img src="./Text generation with an RNN  _  TensorFlow_files/GitHub-Mark-32px.png">View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/text/docs/tutorials/text_generation.ipynb"><img src="./Text generation with an RNN  _  TensorFlow_files/download_logo_32px.png">Download notebook</a>
  </td>
</tr></tbody></table></div>

<p>This tutorial demonstrates how to generate text using a character-based RNN. You will work with a dataset of Shakespeare's writing from Andrej Karpathy's <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">The Unreasonable Effectiveness of Recurrent Neural Networks</a>. Given a sequence of characters from this data ("Shakespear"), train a model to predict the next character in the sequence ("e"). Longer sequences of text can be generated by calling the model repeatedly.</p>
<aside class="note"><strong>Note:</strong><span> Enable GPU acceleration to execute this notebook faster. In Colab: <em>Runtime &gt; Change runtime type &gt; Hardware accelerator &gt; GPU</em>.</span></aside>
<p>This tutorial includes runnable code implemented using <a href="https://www.tensorflow.org/guide/keras/sequential_model">tf.keras</a> and <a href="https://www.tensorflow.org/guide/eager">eager execution</a>. The following is the sample output when the model in this tutorial trained for 30 epochs, and started with the prompt "Q":</p>

<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre translate="no" dir="ltr" is-upgraded="">QUEENE:
I had thought thou hadst a Roman; for the oracle,
Thus by All bids the man against the word,
Which are so weak of care, by old care done;
Your children were in your holy love,
And the precipitation through the bleeding throne.

BISHOP OF ELY:
Marry, and will, my lord, to weep in such a one were prettiest;
Yet now I was adopted heir
Of the world's lamentable day,
To watch the next way with his father with his face?

ESCALUS:
The cause why then we are all resolved more sons.

VOLUMNIA:
O, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, it is no sin it should be dead,
And love and pale as any will to that word.

QUEEN ELIZABETH:
But how long have I heard the soul for this world,
And show his hands of life be proved to stand.

PETRUCHIO:
I say he look'd on, if I must be content
To stay him from the fatal of our country's bliss.
His lordship pluck'd from this sentence then for prey,
And then let us twain, being the moon,
were she such a case as fills m
</pre></devsite-code>

<p>While some of the sentences are grammatical, most do not make sense. The model has not learned the meaning of words, but consider:</p>

<ul>
<li><p>The model is character-based. When training started, the model did not know how to spell an English word, or that words were even a unit of text.</p></li>
<li><p>The structure of the output resembles a play—blocks of text generally begin with a speaker name, in all capital letters similar to the dataset.</p></li>
<li><p>As demonstrated below, the model is trained on small batches of text (100 characters each), and is still able to generate a longer sequence of text with coherent structure.</p></li>
</ul>

<h2 id="setup" data-text="Setup" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Setup</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Setup" data-title="Copy link to this section: Setup" data-id="setup"></button></h2>

<h3 id="import_tensorflow_and_other_libraries" data-text="Import TensorFlow and other libraries" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Import TensorFlow and other libraries</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Import TensorFlow and other libraries" data-title="Copy link to this section: Import TensorFlow and other libraries" data-id="import_tensorflow_and_other_libraries"></button></h3>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">import</span><span class="pln"> tensorflow </span><span class="kwd">as</span><span class="pln"> tf<br><br></span><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np<br></span><span class="kwd">import</span><span class="pln"> os<br></span><span class="kwd">import</span><span class="pln"> time<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">2023-11-16 12:28:52.207051: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-16 12:28:52.207090: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-16 12:28:52.208630: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
</pre></devsite-code>

<h3 id="download_the_shakespeare_dataset" data-text="Download the Shakespeare dataset" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Download the Shakespeare dataset</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Download the Shakespeare dataset" data-title="Copy link to this section: Download the Shakespeare dataset" data-id="download_the_shakespeare_dataset"></button></h3>

<p>Change the following line to run this code on your own data.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">path_to_file </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="pln">get_file</span><span class="pun">(</span><span class="str">'shakespeare.txt'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'https://storage.googleapis.com/download.tensorflow.org/data/shakespeare.txt'</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Downloading data from https://storage.googleapis.com/download.tensorflow.org/data/shakespeare.txt
1115394/1115394 [==============================] - 0s 0us/step
</pre></devsite-code>

<h3 id="read_the_data" data-text="Read the data" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Read the data</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Read the data" data-title="Copy link to this section: Read the data" data-id="read_the_data"></button></h3>

<p>First, look in the text:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># Read, then decode for py2 compat.</span><span class="pln"><br>text </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">path_to_file</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">).</span><span class="pln">read</span><span class="pun">().</span><span class="pln">decode</span><span class="pun">(</span><span class="pln">encoding</span><span class="pun">=</span><span class="str">'utf-8'</span><span class="pun">)</span><span class="pln"><br></span><span class="com"># length of text is the number of characters in it</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">f</span><span class="str">'Length of text: {len(text)} characters'</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Length of text: 1115394 characters
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># Take a look at the first 250 characters in text</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">text</span><span class="pun">[:</span><span class="lit">250</span><span class="pun">])</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">First Citizen:
Before we proceed any further, hear me speak.

All:
Speak, speak.

First Citizen:
You are all resolved rather to die than to famish?

All:
Resolved. resolved.

First Citizen:
First, you know Caius Marcius is chief enemy to the people.
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># The unique characters in the file</span><span class="pln"><br>vocab </span><span class="pun">=</span><span class="pln"> sorted</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">text</span><span class="pun">))</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">f</span><span class="str">'{len(vocab)} unique characters'</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">65 unique characters
</pre></devsite-code>

<h2 id="process_the_text" data-text="Process the text" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Process the text</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Process the text" data-title="Copy link to this section: Process the text" data-id="process_the_text"></button></h2>

<h3 id="vectorize_the_text" data-text="Vectorize the text" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Vectorize the text</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Vectorize the text" data-title="Copy link to this section: Vectorize the text" data-id="vectorize_the_text"></button></h3>

<p>Before training, you need to convert the strings to a numerical representation. </p>

<p>The <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/StringLookup"><code translate="no" dir="ltr">tf.keras.layers.StringLookup</code></a> layer can convert each character into a numeric ID. It just needs the text to be split into tokens first.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">example_texts </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="str">'abcdefg'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'xyz'</span><span class="pun">]</span><span class="pln"><br><br>chars </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unicode_split</span><span class="pun">(</span><span class="pln">example_texts</span><span class="pun">,</span><span class="pln"> input_encoding</span><span class="pun">=</span><span class="str">'UTF-8'</span><span class="pun">)</span><span class="pln"><br>chars<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">&lt;tf.RaggedTensor [[b'a', b'b', b'c', b'd', b'e', b'f', b'g'], [b'x', b'y', b'z']]&gt;
</pre></devsite-code>

<p>Now create the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/StringLookup"><code translate="no" dir="ltr">tf.keras.layers.StringLookup</code></a> layer:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">ids_from_chars </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">layers</span><span class="pun">.</span><span class="typ">StringLookup</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; vocabulary</span><span class="pun">=</span><span class="pln">list</span><span class="pun">(</span><span class="pln">vocab</span><span class="pun">),</span><span class="pln"> mask_token</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<p>It converts from tokens to character IDs:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">ids </span><span class="pun">=</span><span class="pln"> ids_from_chars</span><span class="pun">(</span><span class="pln">chars</span><span class="pun">)</span><span class="pln"><br>ids<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">&lt;tf.RaggedTensor [[40, 41, 42, 43, 44, 45, 46], [63, 64, 65]]&gt;
</pre></devsite-code>

<p>Since the goal of this tutorial is to generate text, it will also be important to invert this representation and recover human-readable strings from it. For this you can use <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/StringLookup"><code translate="no" dir="ltr">tf.keras.layers.StringLookup(..., invert=True)</code></a>.  </p>
<aside class="note"><strong>Note:</strong><span> Here instead of passing the original vocabulary generated with <code translate="no" dir="ltr">sorted(set(text))</code> use the <code translate="no" dir="ltr">get_vocabulary()</code> method of the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/StringLookup"><code translate="no" dir="ltr">tf.keras.layers.StringLookup</code></a> layer so that the <code translate="no" dir="ltr">[UNK]</code> tokens is set the same way.</span></aside><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">chars_from_ids </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">layers</span><span class="pun">.</span><span class="typ">StringLookup</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; vocabulary</span><span class="pun">=</span><span class="pln">ids_from_chars</span><span class="pun">.</span><span class="pln">get_vocabulary</span><span class="pun">(),</span><span class="pln"> invert</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> mask_token</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<p>This layer recovers the characters from the vectors of IDs, and returns them as a <a href="https://www.tensorflow.org/api_docs/python/tf/RaggedTensor"><code translate="no" dir="ltr">tf.RaggedTensor</code></a> of characters:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">chars </span><span class="pun">=</span><span class="pln"> chars_from_ids</span><span class="pun">(</span><span class="pln">ids</span><span class="pun">)</span><span class="pln"><br>chars<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">&lt;tf.RaggedTensor [[b'a', b'b', b'c', b'd', b'e', b'f', b'g'], [b'x', b'y', b'z']]&gt;
</pre></devsite-code>

<p>You can <a href="https://www.tensorflow.org/api_docs/python/tf/strings/reduce_join"><code translate="no" dir="ltr">tf.strings.reduce_join</code></a> to join the characters back into strings. </p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">reduce_join</span><span class="pun">(</span><span class="pln">chars</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">()</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">array([b'abcdefg', b'xyz'], dtype=object)
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">def</span><span class="pln"> text_from_ids</span><span class="pun">(</span><span class="pln">ids</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">reduce_join</span><span class="pun">(</span><span class="pln">chars_from_ids</span><span class="pun">(</span><span class="pln">ids</span><span class="pun">),</span><span class="pln"> axis</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<h3 id="the_prediction_task" data-text="The prediction task" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">The prediction task</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: The prediction task" data-title="Copy link to this section: The prediction task" data-id="the_prediction_task"></button></h3>

<p>Given a character, or a sequence of characters, what is the most probable next character? This is the task you're training the model to perform. The input to the model will be a sequence of characters, and you train the model to predict the output—the following character at each time step.</p>

<p>Since RNNs maintain an internal state that depends on the previously seen elements, given all the characters computed until this moment, what is the next character?</p>

<h3 id="create_training_examples_and_targets" data-text="Create training examples and targets" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Create training examples and targets</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Create training examples and targets" data-title="Copy link to this section: Create training examples and targets" data-id="create_training_examples_and_targets"></button></h3>

<p>Next divide the text into example sequences. Each input sequence will contain <code translate="no" dir="ltr">seq_length</code> characters from the text.</p>

<p>For each input sequence, the corresponding targets contain the same length of text, except shifted one character to the right.</p>

<p>So break the text into chunks of <code translate="no" dir="ltr">seq_length+1</code>. For example, say <code translate="no" dir="ltr">seq_length</code> is 4 and our text is "Hello". The input sequence would be "Hell", and the target sequence "ello".</p>

<p>To do this first use the <a href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset#from_tensor_slices"><code translate="no" dir="ltr">tf.data.Dataset.from_tensor_slices</code></a> function to convert the text vector into a stream of character indices.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">all_ids </span><span class="pun">=</span><span class="pln"> ids_from_chars</span><span class="pun">(</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unicode_split</span><span class="pun">(</span><span class="pln">text</span><span class="pun">,</span><span class="pln"> </span><span class="str">'UTF-8'</span><span class="pun">))</span><span class="pln"><br>all_ids<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">&lt;tf.Tensor: shape=(1115394,), dtype=int64, numpy=array([19, 48, 57, ..., 46,  9,  1])&gt;
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">ids_dataset </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="typ">Dataset</span><span class="pun">.</span><span class="pln">from_tensor_slices</span><span class="pun">(</span><span class="pln">all_ids</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">for</span><span class="pln"> ids </span><span class="kwd">in</span><span class="pln"> ids_dataset</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="lit">10</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">chars_from_ids</span><span class="pun">(</span><span class="pln">ids</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">().</span><span class="pln">decode</span><span class="pun">(</span><span class="str">'utf-8'</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">F
i
r
s
t
 
C
i
t
i
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">seq_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">100</span><span class="pln"><br></span></code></pre></devsite-code>
<p>The <code translate="no" dir="ltr">batch</code> method lets you easily convert these individual characters to sequences of the desired size.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">sequences </span><span class="pun">=</span><span class="pln"> ids_dataset</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">(</span><span class="pln">seq_length</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> drop_remainder</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br><br></span><span class="kwd">for</span><span class="pln"> seq </span><span class="kwd">in</span><span class="pln"> sequences</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="lit">1</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">chars_from_ids</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">tf.Tensor(
[b'F' b'i' b'r' b's' b't' b' ' b'C' b'i' b't' b'i' b'z' b'e' b'n' b':'
 b'\n' b'B' b'e' b'f' b'o' b'r' b'e' b' ' b'w' b'e' b' ' b'p' b'r' b'o'
 b'c' b'e' b'e' b'd' b' ' b'a' b'n' b'y' b' ' b'f' b'u' b'r' b't' b'h'
 b'e' b'r' b',' b' ' b'h' b'e' b'a' b'r' b' ' b'm' b'e' b' ' b's' b'p'
 b'e' b'a' b'k' b'.' b'\n' b'\n' b'A' b'l' b'l' b':' b'\n' b'S' b'p' b'e'
 b'a' b'k' b',' b' ' b's' b'p' b'e' b'a' b'k' b'.' b'\n' b'\n' b'F' b'i'
 b'r' b's' b't' b' ' b'C' b'i' b't' b'i' b'z' b'e' b'n' b':' b'\n' b'Y'
 b'o' b'u' b' '], shape=(101,), dtype=string)
</pre></devsite-code>

<p>It's easier to see what this is doing if you join the tokens back into strings:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">for</span><span class="pln"> seq </span><span class="kwd">in</span><span class="pln"> sequences</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="lit">5</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">text_from_ids</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">())</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">b'First Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou '
b'are all resolved rather to die than to famish?\n\nAll:\nResolved. resolved.\n\nFirst Citizen:\nFirst, you k'
b"now Caius Marcius is chief enemy to the people.\n\nAll:\nWe know't, we know't.\n\nFirst Citizen:\nLet us ki"
b"ll him, and we'll have corn at our own price.\nIs't a verdict?\n\nAll:\nNo more talking on't; let it be d"
b'one: away, away!\n\nSecond Citizen:\nOne word, good citizens.\n\nFirst Citizen:\nWe are accounted poor citi'
</pre></devsite-code>

<p>For training you'll need a dataset of <code translate="no" dir="ltr">(input, label)</code> pairs. Where <code translate="no" dir="ltr">input</code> and 
<code translate="no" dir="ltr">label</code> are sequences. At each time step the input is the current character and the label is the next character. </p>

<p>Here's a function that takes a sequence as input, duplicates, and shifts it to align the input and label for each timestep:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">def</span><span class="pln"> split_input_target</span><span class="pun">(</span><span class="pln">sequence</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; input_text </span><span class="pun">=</span><span class="pln"> sequence</span><span class="pun">[:-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"><br>&nbsp; &nbsp; target_text </span><span class="pun">=</span><span class="pln"> sequence</span><span class="pun">[</span><span class="lit">1</span><span class="pun">:]</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> input_text</span><span class="pun">,</span><span class="pln"> target_text<br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">split_input_target</span><span class="pun">(</span><span class="pln">list</span><span class="pun">(</span><span class="str">"Tensorflow"</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">(['T', 'e', 'n', 's', 'o', 'r', 'f', 'l', 'o'],
 ['e', 'n', 's', 'o', 'r', 'f', 'l', 'o', 'w'])
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">dataset </span><span class="pun">=</span><span class="pln"> sequences</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(</span><span class="pln">split_input_target</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">for</span><span class="pln"> input_example</span><span class="pun">,</span><span class="pln"> target_example </span><span class="kwd">in</span><span class="pln"> dataset</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="lit">1</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Input :"</span><span class="pun">,</span><span class="pln"> text_from_ids</span><span class="pun">(</span><span class="pln">input_example</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">())</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Target:"</span><span class="pun">,</span><span class="pln"> text_from_ids</span><span class="pun">(</span><span class="pln">target_example</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">())</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Input : b'First Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou'
Target: b'irst Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou '
</pre></devsite-code>

<h3 id="create_training_batches" data-text="Create training batches" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Create training batches</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Create training batches" data-title="Copy link to this section: Create training batches" data-id="create_training_batches"></button></h3>

<p>You used <a href="https://www.tensorflow.org/api_docs/python/tf/data"><code translate="no" dir="ltr">tf.data</code></a> to split the text into manageable sequences. But before feeding this data into the model, you need to shuffle the data and pack it into batches.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># Batch size</span><span class="pln"><br>BATCH_SIZE </span><span class="pun">=</span><span class="pln"> </span><span class="lit">64</span><span class="pln"><br><br></span><span class="com"># Buffer size to shuffle the dataset</span><span class="pln"><br></span><span class="com"># (TF data is designed to work with possibly infinite sequences,</span><span class="pln"><br></span><span class="com"># so it doesn't attempt to shuffle the entire sequence in memory. Instead,</span><span class="pln"><br></span><span class="com"># it maintains a buffer in which it shuffles elements).</span><span class="pln"><br>BUFFER_SIZE </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10000</span><span class="pln"><br><br>dataset </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; dataset<br>&nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">shuffle</span><span class="pun">(</span><span class="pln">BUFFER_SIZE</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">batch</span><span class="pun">(</span><span class="pln">BATCH_SIZE</span><span class="pun">,</span><span class="pln"> drop_remainder</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">prefetch</span><span class="pun">(</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">experimental</span><span class="pun">.</span><span class="pln">AUTOTUNE</span><span class="pun">))</span><span class="pln"><br><br>dataset<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">&lt;_PrefetchDataset element_spec=(TensorSpec(shape=(64, 100), dtype=tf.int64, name=None), TensorSpec(shape=(64, 100), dtype=tf.int64, name=None))&gt;
</pre></devsite-code>

<h2 id="build_the_model" data-text="Build The Model" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Build The Model</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Build The Model" data-title="Copy link to this section: Build The Model" data-id="build_the_model"></button></h2>

<p>This section defines the model as a <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code translate="no" dir="ltr">keras.Model</code></a> subclass (For details see <a href="https://www.tensorflow.org/guide/keras/custom_layers_and_models">Making new Layers and Models via subclassing</a>). </p>

<p>This model has three layers:</p>

<ul>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Embedding"><code translate="no" dir="ltr">tf.keras.layers.Embedding</code></a>: The input layer. A trainable lookup table that will map each character-ID to a vector with <code translate="no" dir="ltr">embedding_dim</code> dimensions;</li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/GRU"><code translate="no" dir="ltr">tf.keras.layers.GRU</code></a>: A type of RNN with size <code translate="no" dir="ltr">units=rnn_units</code> (You can also use an LSTM layer here.)</li>
<li><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense"><code translate="no" dir="ltr">tf.keras.layers.Dense</code></a>: The output layer, with <code translate="no" dir="ltr">vocab_size</code> outputs. It outputs one logit for each character in the vocabulary. These are the log-likelihood of each character according to the model.</li>
</ul>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># Length of the vocabulary in StringLookup Layer</span><span class="pln"><br>vocab_size </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">ids_from_chars</span><span class="pun">.</span><span class="pln">get_vocabulary</span><span class="pun">())</span><span class="pln"><br><br></span><span class="com"># The embedding dimension</span><span class="pln"><br>embedding_dim </span><span class="pun">=</span><span class="pln"> </span><span class="lit">256</span><span class="pln"><br><br></span><span class="com"># Number of RNN units</span><span class="pln"><br>rnn_units </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1024</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyModel</span><span class="pun">(</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="typ">Model</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> vocab_size</span><span class="pun">,</span><span class="pln"> embedding_dim</span><span class="pun">,</span><span class="pln"> rnn_units</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">super</span><span class="pun">().</span><span class="pln">__init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">embedding </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">layers</span><span class="pun">.</span><span class="typ">Embedding</span><span class="pun">(</span><span class="pln">vocab_size</span><span class="pun">,</span><span class="pln"> embedding_dim</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gru </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">layers</span><span class="pun">.</span><span class="pln">GRU</span><span class="pun">(</span><span class="pln">rnn_units</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return_sequences</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return_state</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dense </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">layers</span><span class="pun">.</span><span class="typ">Dense</span><span class="pun">(</span><span class="pln">vocab_size</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> call</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> inputs</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> return_state</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> training</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> inputs<br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">embedding</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> training</span><span class="pun">=</span><span class="pln">training</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> states </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gru</span><span class="pun">.</span><span class="pln">get_initial_state</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; x</span><span class="pun">,</span><span class="pln"> states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">gru</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> initial_state</span><span class="pun">=</span><span class="pln">states</span><span class="pun">,</span><span class="pln"> training</span><span class="pun">=</span><span class="pln">training</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">dense</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> training</span><span class="pun">=</span><span class="pln">training</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> return_state</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> states<br>&nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> x<br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MyModel</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; vocab_size</span><span class="pun">=</span><span class="pln">vocab_size</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; embedding_dim</span><span class="pun">=</span><span class="pln">embedding_dim</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; rnn_units</span><span class="pun">=</span><span class="pln">rnn_units</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<p>For each character the model looks up the embedding, runs the GRU one timestep with the embedding as input, and applies the dense layer to generate logits predicting the log-likelihood of the next character:</p>

<p><img src="./Text generation with an RNN  _  TensorFlow_files/text_generation_training.png" alt="A drawing of the data passing through the model"></p>
<aside class="note"><strong>Note:</strong><span> For training you could use a <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Sequential"><code translate="no" dir="ltr">keras.Sequential</code></a> model here. To  generate text later you'll need to manage the RNN's internal state. It's simpler to include the state input and output options upfront, than it is to rearrange the model architecture later. For more details see the <a href="https://www.tensorflow.org/guide/keras/rnn#rnn_state_reuse">Keras RNN guide</a>.</span></aside>
<h2 id="try_the_model" data-text="Try the model" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Try the model</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Try the model" data-title="Copy link to this section: Try the model" data-id="try_the_model"></button></h2>

<p>Now run the model to see that it behaves as expected.</p>

<p>First check the shape of the output:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">for</span><span class="pln"> input_example_batch</span><span class="pun">,</span><span class="pln"> target_example_batch </span><span class="kwd">in</span><span class="pln"> dataset</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="lit">1</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; example_batch_predictions </span><span class="pun">=</span><span class="pln"> model</span><span class="pun">(</span><span class="pln">input_example_batch</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">example_batch_predictions</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">,</span><span class="pln"> </span><span class="str">"# (batch_size, sequence_length, vocab_size)"</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">(64, 100, 66) # (batch_size, sequence_length, vocab_size)
</pre></devsite-code>

<p>In the above example the sequence length of the input is <code translate="no" dir="ltr">100</code> but the model can be run on inputs of any length:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">()</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Model: "my_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding (Embedding)       multiple                  16896     
                                                                 
 gru (GRU)                   multiple                  3938304   
                                                                 
 dense (Dense)               multiple                  67650     
                                                                 
=================================================================
Total params: 4022850 (15.35 MB)
Trainable params: 4022850 (15.35 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
</pre></devsite-code>

<p>To get actual predictions from the model you need to sample from the output distribution, to get actual character indices. This distribution is defined by the logits over the character vocabulary.</p>
<aside class="note"><strong>Note:</strong><span> It is important to <em>sample</em> from this distribution as taking the <em>argmax</em> of the distribution can easily get the model stuck in a loop.</span></aside>
<p>Try it for the first example in the batch:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">sampled_indices </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">categorical</span><span class="pun">(</span><span class="pln">example_batch_predictions</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> num_samples</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>sampled_indices </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">(</span><span class="pln">sampled_indices</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">()</span><span class="pln"><br></span></code></pre></devsite-code>
<p>This gives us, at each timestep, a prediction of the next character index:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">sampled_indices<br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">array([15, 52, 19, 34,  6, 39, 41, 62, 50, 61, 42, 26, 29, 57, 34, 46, 12,
       61, 53, 14, 26, 50,  5,  8, 29, 44,  2, 65, 62, 52, 53, 26, 25, 39,
       64, 36, 53, 21, 34, 30, 12, 58, 61, 43, 38, 29,  1, 26, 47, 35, 52,
       30, 10, 20, 59,  9, 11, 34, 59, 45, 56, 20, 39, 29, 46, 10, 54, 56,
       57, 17, 19, 19, 14, 40, 12, 12,  4, 54, 22, 17, 31,  7, 61, 44, 56,
       36,  5, 38, 30, 32, 23, 21, 52, 39, 42, 30, 42,  8, 17, 53])
</pre></devsite-code>

<p>Decode these to see the text predicted by this untrained model:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Input:\n"</span><span class="pun">,</span><span class="pln"> text_from_ids</span><span class="pun">(</span><span class="pln">input_example_batch</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]).</span><span class="pln">numpy</span><span class="pun">())</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">()</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Next Char Predictions:\n"</span><span class="pun">,</span><span class="pln"> text_from_ids</span><span class="pun">(</span><span class="pln">sampled_indices</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">())</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Input:
 b" of woman in the world,\nAy, every dram of woman's flesh is false, If she be.\n\nLEONTES:\nHold your pea"

Next Char Predictions:
 b"BmFU'ZbwkvcMPrUg;vnAMk&amp;-Pe zwmnMLZyWnHUQ;svdYP\nMhVmQ3Gt.:UtfqGZPg3oqrDFFAa;;$oIDR,veqW&amp;YQSJHmZcQc-Dn"
</pre></devsite-code>

<h2 id="train_the_model" data-text="Train the model" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Train the model</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Train the model" data-title="Copy link to this section: Train the model" data-id="train_the_model"></button></h2>

<p>At this point the problem can be treated as a standard classification problem. Given the previous RNN state, and the input this time step, predict the class of the next character.</p>

<h3 id="attach_an_optimizer_and_a_loss_function" data-text="Attach an optimizer, and a loss function" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Attach an optimizer,<wbr> and a loss function</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Attach an optimizer, and a loss function" data-title="Copy link to this section: Attach an optimizer, and a loss function" data-id="attach_an_optimizer_and_a_loss_function"></button></h3>

<p>The standard <a href="https://www.tensorflow.org/api_docs/python/tf/keras/metrics/sparse_categorical_crossentropy"><code translate="no" dir="ltr">tf.keras.losses.sparse_categorical_crossentropy</code></a> loss function works in this case because it is applied across the last dimension of the predictions.</p>

<p>Because your model returns logits, you need to set the <code translate="no" dir="ltr">from_logits</code> flag.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">loss </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">losses</span><span class="pun">.</span><span class="typ">SparseCategoricalCrossentropy</span><span class="pun">(</span><span class="pln">from_logits</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">example_batch_mean_loss </span><span class="pun">=</span><span class="pln"> loss</span><span class="pun">(</span><span class="pln">target_example_batch</span><span class="pun">,</span><span class="pln"> example_batch_predictions</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Prediction shape: "</span><span class="pun">,</span><span class="pln"> example_batch_predictions</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">,</span><span class="pln"> </span><span class="str">" # (batch_size, sequence_length, vocab_size)"</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Mean loss: &nbsp; &nbsp; &nbsp; &nbsp;"</span><span class="pun">,</span><span class="pln"> example_batch_mean_loss</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Prediction shape:  (64, 100, 66)  # (batch_size, sequence_length, vocab_size)
Mean loss:         tf.Tensor(4.1884556, shape=(), dtype=float32)
</pre></devsite-code>

<p>A newly initialized model shouldn't be too sure of itself, the output logits should all have similar magnitudes. To confirm this you can check that the exponential of the mean loss is approximately equal to the vocabulary size. A much higher loss means the model is sure of its wrong answers, and is badly initialized:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">tf</span><span class="pun">.</span><span class="pln">exp</span><span class="pun">(</span><span class="pln">example_batch_mean_loss</span><span class="pun">).</span><span class="pln">numpy</span><span class="pun">()</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">65.920906
</pre></devsite-code>

<p>Configure the training procedure using the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#compile"><code translate="no" dir="ltr">tf.keras.Model.compile</code></a> method. Use <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam"><code translate="no" dir="ltr">tf.keras.optimizers.Adam</code></a> with default arguments and the loss function.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">optimizer</span><span class="pun">=</span><span class="str">'adam'</span><span class="pun">,</span><span class="pln"> loss</span><span class="pun">=</span><span class="pln">loss</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<h3 id="configure_checkpoints" data-text="Configure checkpoints" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Configure checkpoints</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Configure checkpoints" data-title="Copy link to this section: Configure checkpoints" data-id="configure_checkpoints"></button></h3>

<p>Use a <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/ModelCheckpoint"><code translate="no" dir="ltr">tf.keras.callbacks.ModelCheckpoint</code></a> to ensure that checkpoints are saved during training:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="com"># Directory where the checkpoints will be saved</span><span class="pln"><br>checkpoint_dir </span><span class="pun">=</span><span class="pln"> </span><span class="str">'./training_checkpoints'</span><span class="pln"><br></span><span class="com"># Name of the checkpoint files</span><span class="pln"><br>checkpoint_prefix </span><span class="pun">=</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">checkpoint_dir</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ckpt_{epoch}"</span><span class="pun">)</span><span class="pln"><br><br>checkpoint_callback </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">callbacks</span><span class="pun">.</span><span class="typ">ModelCheckpoint</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; filepath</span><span class="pun">=</span><span class="pln">checkpoint_prefix</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; save_weights_only</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<h3 id="execute_the_training" data-text="Execute the training" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="3">Execute the training</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Execute the training" data-title="Copy link to this section: Execute the training" data-id="execute_the_training"></button></h3>

<p>To keep training time reasonable, use 10 epochs to train the model. In Colab, set the runtime to GPU for faster training.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">EPOCHS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">20</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">history </span><span class="pun">=</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">dataset</span><span class="pun">,</span><span class="pln"> epochs</span><span class="pun">=</span><span class="pln">EPOCHS</span><span class="pun">,</span><span class="pln"> callbacks</span><span class="pun">=[</span><span class="pln">checkpoint_callback</span><span class="pun">])</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Epoch 1/20
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1700137742.036116   34050 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
172/172 [==============================] - 12s 53ms/step - loss: 2.7219
Epoch 2/20
172/172 [==============================] - 10s 54ms/step - loss: 1.9972
Epoch 3/20
172/172 [==============================] - 11s 55ms/step - loss: 1.7187
Epoch 4/20
172/172 [==============================] - 11s 57ms/step - loss: 1.5568
Epoch 5/20
172/172 [==============================] - 11s 59ms/step - loss: 1.4579
Epoch 6/20
172/172 [==============================] - 11s 61ms/step - loss: 1.3891
Epoch 7/20
172/172 [==============================] - 12s 61ms/step - loss: 1.3356
Epoch 8/20
172/172 [==============================] - 12s 62ms/step - loss: 1.2913
Epoch 9/20
172/172 [==============================] - 11s 60ms/step - loss: 1.2501
Epoch 10/20
172/172 [==============================] - 11s 59ms/step - loss: 1.2090
Epoch 11/20
172/172 [==============================] - 11s 59ms/step - loss: 1.1693
Epoch 12/20
172/172 [==============================] - 11s 59ms/step - loss: 1.1283
Epoch 13/20
172/172 [==============================] - 11s 60ms/step - loss: 1.0859
Epoch 14/20
172/172 [==============================] - 11s 61ms/step - loss: 1.0391
Epoch 15/20
172/172 [==============================] - 11s 61ms/step - loss: 0.9928
Epoch 16/20
172/172 [==============================] - 11s 61ms/step - loss: 0.9408
Epoch 17/20
172/172 [==============================] - 11s 60ms/step - loss: 0.8888
Epoch 18/20
172/172 [==============================] - 11s 60ms/step - loss: 0.8361
Epoch 19/20
172/172 [==============================] - 11s 60ms/step - loss: 0.7840
Epoch 20/20
172/172 [==============================] - 11s 60ms/step - loss: 0.7337
</pre></devsite-code>

<h2 id="generate_text" data-text="Generate text" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Generate text</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Generate text" data-title="Copy link to this section: Generate text" data-id="generate_text"></button></h2>

<p>The simplest way to generate text with this model is to run it in a loop, and keep track of the model's internal state as you execute it.</p>

<p><img src="./Text generation with an RNN  _  TensorFlow_files/text_generation_sampling.png" alt="To generate text the model&#39;s output is fed back to the input"></p>

<p>Each time you call the model you pass in some text and an internal state. The model returns a prediction for the next character and its new state. Pass the prediction and state back in to continue generating text.</p>

<p>The following makes a single step prediction:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">class</span><span class="pln"> </span><span class="typ">OneStep</span><span class="pun">(</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="typ">Model</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> model</span><span class="pun">,</span><span class="pln"> chars_from_ids</span><span class="pun">,</span><span class="pln"> ids_from_chars</span><span class="pun">,</span><span class="pln"> temperature</span><span class="pun">=</span><span class="lit">1.0</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">super</span><span class="pun">().</span><span class="pln">__init__</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">temperature </span><span class="pun">=</span><span class="pln"> temperature<br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">model </span><span class="pun">=</span><span class="pln"> model<br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">chars_from_ids </span><span class="pun">=</span><span class="pln"> chars_from_ids<br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">ids_from_chars </span><span class="pun">=</span><span class="pln"> ids_from_chars<br><br>&nbsp; &nbsp; </span><span class="com"># Create a mask to prevent "[UNK]" from being generated.</span><span class="pln"><br>&nbsp; &nbsp; skip_ids </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">ids_from_chars</span><span class="pun">([</span><span class="str">'[UNK]'</span><span class="pun">])[:,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">]</span><span class="pln"><br>&nbsp; &nbsp; sparse_mask </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="typ">SparseTensor</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com"># Put a -inf at each bad index.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; values</span><span class="pun">=[-</span><span class="kwd">float</span><span class="pun">(</span><span class="str">'inf'</span><span class="pun">)]*</span><span class="pln">len</span><span class="pun">(</span><span class="pln">skip_ids</span><span class="pun">),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; indices</span><span class="pun">=</span><span class="pln">skip_ids</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com"># Match the shape to the vocabulary</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; dense_shape</span><span class="pun">=[</span><span class="pln">len</span><span class="pun">(</span><span class="pln">ids_from_chars</span><span class="pun">.</span><span class="pln">get_vocabulary</span><span class="pun">())])</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">prediction_mask </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">sparse</span><span class="pun">.</span><span class="pln">to_dense</span><span class="pun">(</span><span class="pln">sparse_mask</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; </span><span class="lit">@tf</span><span class="pun">.</span><span class="kwd">function</span><span class="pln"><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> generate_one_step</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> inputs</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com"># Convert strings to token IDs.</span><span class="pln"><br>&nbsp; &nbsp; input_chars </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">unicode_split</span><span class="pun">(</span><span class="pln">inputs</span><span class="pun">,</span><span class="pln"> </span><span class="str">'UTF-8'</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; input_ids </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">ids_from_chars</span><span class="pun">(</span><span class="pln">input_chars</span><span class="pun">).</span><span class="pln">to_tensor</span><span class="pun">()</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com"># Run the model.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com"># predicted_logits.shape is [batch, char, next_char_logits]</span><span class="pln"><br>&nbsp; &nbsp; predicted_logits</span><span class="pun">,</span><span class="pln"> states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">model</span><span class="pun">(</span><span class="pln">inputs</span><span class="pun">=</span><span class="pln">input_ids</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="pln">states</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return_state</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com"># Only use the last prediction.</span><span class="pln"><br>&nbsp; &nbsp; predicted_logits </span><span class="pun">=</span><span class="pln"> predicted_logits</span><span class="pun">[:,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">:]</span><span class="pln"><br>&nbsp; &nbsp; predicted_logits </span><span class="pun">=</span><span class="pln"> predicted_logits</span><span class="pun">/</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">temperature<br>&nbsp; &nbsp; </span><span class="com"># Apply the prediction mask: prevent "[UNK]" from being generated.</span><span class="pln"><br>&nbsp; &nbsp; predicted_logits </span><span class="pun">=</span><span class="pln"> predicted_logits </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">prediction_mask<br><br>&nbsp; &nbsp; </span><span class="com"># Sample the output logits to generate token IDs.</span><span class="pln"><br>&nbsp; &nbsp; predicted_ids </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">categorical</span><span class="pun">(</span><span class="pln">predicted_logits</span><span class="pun">,</span><span class="pln"> num_samples</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; predicted_ids </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">(</span><span class="pln">predicted_ids</span><span class="pun">,</span><span class="pln"> axis</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com"># Convert from token ids to characters</span><span class="pln"><br>&nbsp; &nbsp; predicted_chars </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">chars_from_ids</span><span class="pun">(</span><span class="pln">predicted_ids</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com"># Return the characters and model state.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> predicted_chars</span><span class="pun">,</span><span class="pln"> states<br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">one_step_model </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OneStep</span><span class="pun">(</span><span class="pln">model</span><span class="pun">,</span><span class="pln"> chars_from_ids</span><span class="pun">,</span><span class="pln"> ids_from_chars</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<p>Run it in a loop to generate some text. Looking at the generated text, you'll see the model knows when to capitalize, make paragraphs and imitates a Shakespeare-like writing vocabulary. With the small number of training epochs, it has not yet learned to form coherent sentences.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()</span><span class="pln"><br>states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pln"><br>next_char </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">constant</span><span class="pun">([</span><span class="str">'ROMEO:'</span><span class="pun">])</span><span class="pln"><br>result </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">next_char</span><span class="pun">]</span><span class="pln"><br><br></span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1000</span><span class="pun">):</span><span class="pln"><br>&nbsp; next_char</span><span class="pun">,</span><span class="pln"> states </span><span class="pun">=</span><span class="pln"> one_step_model</span><span class="pun">.</span><span class="pln">generate_one_step</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="pln">states</span><span class="pun">)</span><span class="pln"><br>&nbsp; result</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">)</span><span class="pln"><br><br>result </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">result</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">end</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">result</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">numpy</span><span class="pun">().</span><span class="pln">decode</span><span class="pun">(</span><span class="str">'utf-8'</span><span class="pun">),</span><span class="pln"> </span><span class="str">'\n\n'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">'_'</span><span class="pun">*</span><span class="lit">80</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="str">'\nRun time:'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">end</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> start</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">ROMEO:
The dayning use your brodous parchemn a memaver
But to my shrow against it.

CURTIS:
Do you think of't, leaving too?

QUEEN ELIZABETH:
It is, sir, let's see: to put my freedy-sorrow
In the resolution of the fell as of;
And she shall to the fish, whose parts-have
drey'd the process or owe we eptits the abtent,
That they have often been men asiel, as now
I lay stoly to none of your adversary title.
Nay, stay, what, nurse, shall I respect by him. Assisted with,
Hadst thou depart; we should have seen some name of meat:
Might from this coast was though his purpose, and they can ffor me to
And lack upon your royal king.

DUKE VINCENTIO:
It is now pale; but not a man with winds,
And breathed sunshine way: in give of less, the nurse
In thy extreme budden and his wives.
One more, most noble friend.

Third Servingman:
I have no more of it.

FRIAR LAURENCE:
O, she is found withal. Hark ye
and given me thence at we? or die among thes?
Evermother, Thomas, Duke old York and him,
So fast aspected: s 

________________________________________________________________________________

Run time: 2.878746271133423
</pre></devsite-code>

<p>The easiest thing you can do to improve the results is to train it for longer (try <code translate="no" dir="ltr">EPOCHS = 30</code>).</p>

<p>You can also experiment with a different start string, try adding another RNN layer to improve the model's accuracy, or adjust the temperature parameter to generate more or less random predictions.</p>

<p>If you want the model to generate text <em>faster</em> the easiest thing you can do is batch the text generation. In the example below the model generates 5 outputs in about the same time it took to generate 1 above. </p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()</span><span class="pln"><br>states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pln"><br>next_char </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">constant</span><span class="pun">([</span><span class="str">'ROMEO:'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ROMEO:'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ROMEO:'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ROMEO:'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ROMEO:'</span><span class="pun">])</span><span class="pln"><br>result </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">next_char</span><span class="pun">]</span><span class="pln"><br><br></span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1000</span><span class="pun">):</span><span class="pln"><br>&nbsp; next_char</span><span class="pun">,</span><span class="pln"> states </span><span class="pun">=</span><span class="pln"> one_step_model</span><span class="pun">.</span><span class="pln">generate_one_step</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="pln">states</span><span class="pun">)</span><span class="pln"><br>&nbsp; result</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">)</span><span class="pln"><br><br>result </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">result</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">end</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">result</span><span class="pun">,</span><span class="pln"> </span><span class="str">'\n\n'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">'_'</span><span class="pun">*</span><span class="lit">80</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">print</span><span class="pun">(</span><span class="str">'\nRun time:'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">end</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> start</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">tf.Tensor(
[b"ROMEO:\nFirst, heaven leave us: O, rest thy wild,\nI will my father dead?\n\nTRANIO:\nBut did you send us run; lay, fool!\nI would the world say no; what brought to? hear?\n\nKATHARINA:\nFear you the heavess to take away the time\nof a kiss of sold murder, to keep this luck\nWhose uncle branches order, I cry you\ndo, and the moting father of the like days\nThey shall seem from reason, whilst I live or else\nTo raise his writing fallent to speak.\nBut, Clifford, he is gone unto these wents were faults.\n\nLUCENTIO:\nAh, Warwick, art thou hear, the worst of in my false\nMoth thy meaning brave through the seas.\nIn what occasion not thyself?\n\nMONTAGUE:\nGood queen; Antigons, and brave amazed at the\ngreaty will out-plane. Calm those that valiant quench,\nthough us't! it is your baseness. Come, sit down;\nFor, madam: son, away! Now, by the worst.\n\nAll:\nTeems as it hath mest.\n\nDORSET:\nAnd love as you; I could heed home.\nAlas! I needs must out, as thou art a\nfraitors hate than for the year, and the conquer'd bowes\nIn gro"
 b"ROMEO:\n\nJULIET:\nAs well return.\n\nShepherd:\nBut, good my lord,\nThe Duke of Clarence hath so\n't born: but all, within mine own absence\nI married my face, moved nor boy;\nAnd I from Deepany, advangal keeps and cheer\nOf heaven nor power, at some thread.\nThat English jedwats shall not stuck a dream;\nFairer that proud thoughts about the abonty of the crown.\n\nJULIET:\nThen, I may have now, she you seal the story\nWhere nowing an oath with lips.\n\nKING RICHARD II:\nDiscourse of any good conceit? Abas!\nMy gracious sovereitn, ladies that vaunts in\nhis wonder age; but yet we should hear\nMy words shed by, and thought on sue the word,\nFor, lords, to-marry my greatness: if my trotubous lies?\n\nLADY GREY:\nTo his submission. Lady and Darb.\n\nDUCHESS OF YORK:\nWouldst thou go? then I'll judge my tongue,\nAnd graced trembling of the widdows, or\nshe's the cause? a coucle's hand thither? O!\nBelance oph?\n\nESCALUS:\nAy; for thou wert kill'd\nwhen the wall's power I could's high a peal: be corn\nAt o'cropph the instrument of "
 b"ROMEO:\nOr else be swellest Edward: if this long-impellow:\nAll unacounted said Lecious honour have many sortons\nThat first we all go men.\n\nDUKE OF YORK:\nWelcome, my lord, widow!\n\nALONS:\nIf it be not; she was not made a queen,\n'This people will still have mine eyes to heaven from his wife.\n\nTHOMAS MOWBRAY:\nAy, ay.\n\nCitizens:\nDown, ladies,--which is my name is Edward.\nWhen yet she finds alone.\n\nBRAKENBURIO:\nBoth, young and older,, marry; nor my countenance, I did see\nForbidst unreasonably of our queen,--\n\nSTAN:\nI know, I thank thee, knew whose heads the rest,\nBut that the rodut of this speech,\nIs this of noble things you have.\n\nDUKE OF YORK:\nAy, so: you are hereafter, it may make you an\na-bow-forth. But O, pity!\nMake your affections are up, Signior Lucentio.\n\nLUCENTIO:\nIt may not pass:\nThen we shall be most well. but drawly pay\nMe all the world's shore: Alack the dire dream of your sword,\nOne that our kingdom to the head of monsminy.\n\nPRINCE EDWARD:\nAn is her fawling! here's your done,\nHe Canst"
 b"ROMEO:\nLet me see: there were heard.\n\nGLOUCESTER:\n\nKING EDWARD IV:\nAn beast my wife's will obey: how meaning in him, sin\nJest, and thou shalt smile at the fashion;\nFor inholence my most courtiesy, Warwick, steble,\nThou mayst not, sawn, Kate, and then Oxford's vast\nIs sworn to lay at honours on my head\nOf her travel the curses; but we shall bear it.\n\nROMEO:\nNot one would please, as I brother!\n\nCLAUDIO:\nPett up, I,\nWe cannot white of this.\n\nRIVERS:\nAy, for once whither that's no remembrance?\nThou ammonest not most partly keeps, new,\nShould we were cross-wounded to sadver a lord,\nThe horn and holy thank your soldiers arm,\nYou advice for his head to Margar to resign his cloace:\nSure thy wife indeed are womanish.\n\nLUCENTIO:\nThen, good my lord, what talk I possess;\nAnd for the county will he did bear\nOf free speech; and will assect thee,\nThat stands the thrawhilderful: whom I do, an either painted stain\nThe spirits of their power. If you requires a mettain,\nYour mess arrormmeth in either. But we m"
 b"ROMEO:\nWhy, so; farewell: one in, another death or dread\nWhen he were leons.\nSo first less thou the time 'twere my badied known,\nChequering to you.\n\nShepherd:\nGo heaven and false, she's highbell'd.\n\nGLOUCESTER:\nCome, go with you, be with him, if the condaction tears\nHe thither was post to revenge,\nAnd thither shall we could grace to the white:\nThou art to-more oraple! Rise of it!\n\nCOMINIUS:\nKeere yes; if we all shall fork\nAs every cousin, drawn.\n\nPRINCE EDWARD:\nLet me unkiss! my master is safe, Furils, take your power\nTo embraceous have at the goor humour and as yours,\nAnd pluck my babes against your tears, and there before the\ncut; or if she were hered betwixt his ease.'\n\nGLOUCESTER:\nHe reverend guilt return.\n\nPARIS:\nIn vain for your name\nIs not denied and drooping too.\n\nQUEEN MARGARET:\nWhat, thou? whence could not, how?\nSail note or two!\nWho stands the matter:--Now, payied and recensit, anst\nthen to fear every end on the matom, I\nam proud to meet your gate upon her mastray's.\n\nFLORIZEL:\nDo"], shape=(5,), dtype=string) 

________________________________________________________________________________

Run time: 2.8853743076324463
</pre></devsite-code>

<h2 id="export_the_generator" data-text="Export the generator" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Export the generator</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Export the generator" data-title="Copy link to this section: Export the generator" data-id="export_the_generator"></button></h2>

<p>This single-step model can easily be <a href="https://www.tensorflow.org/guide/saved_model">saved and restored</a>, allowing you to use it anywhere a <a href="https://www.tensorflow.org/api_docs/python/tf/saved_model"><code translate="no" dir="ltr">tf.saved_model</code></a> is accepted.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">tf</span><span class="pun">.</span><span class="pln">saved_model</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">one_step_model</span><span class="pun">,</span><span class="pln"> </span><span class="str">'one_step'</span><span class="pun">)</span><span class="pln"><br>one_step_reloaded </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">saved_model</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="str">'one_step'</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">WARNING:tensorflow:Skipping full serialization of Keras layer &lt;__main__.OneStep object at 0x7f1a9c2e6880&gt;, because it is not built.
WARNING:tensorflow:Model's `__init__()` arguments contain non-serializable objects. Please implement a `get_config()` method in the subclassed Model for proper saving and loading. Defaulting to empty config.
WARNING:tensorflow:Model's `__init__()` arguments contain non-serializable objects. Please implement a `get_config()` method in the subclassed Model for proper saving and loading. Defaulting to empty config.
INFO:tensorflow:Assets written to: one_step/assets
INFO:tensorflow:Assets written to: one_step/assets
</pre></devsite-code>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">states </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">None</span><span class="pln"><br>next_char </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">constant</span><span class="pun">([</span><span class="str">'ROMEO:'</span><span class="pun">])</span><span class="pln"><br>result </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">next_char</span><span class="pun">]</span><span class="pln"><br><br></span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">100</span><span class="pun">):</span><span class="pln"><br>&nbsp; next_char</span><span class="pun">,</span><span class="pln"> states </span><span class="pun">=</span><span class="pln"> one_step_reloaded</span><span class="pun">.</span><span class="pln">generate_one_step</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">,</span><span class="pln"> states</span><span class="pun">=</span><span class="pln">states</span><span class="pun">)</span><span class="pln"><br>&nbsp; result</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">next_char</span><span class="pun">)</span><span class="pln"><br><br></span><span class="kwd">print</span><span class="pun">(</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">strings</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">result</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">numpy</span><span class="pun">().</span><span class="pln">decode</span><span class="pun">(</span><span class="str">"utf-8"</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">ROMEO:
While shall we toward them, gaunt and married. Urped me say I
doubt not, for this world is gentle,
</pre></devsite-code>

<h2 id="advanced_customized_training" data-text="Advanced: Customized Training" tabindex="-1" role="presentation"><span class="devsite-heading" role="heading" aria-level="2">Advanced: Customized Training</span><button type="button" class="devsite-heading-link button-flat material-icons" aria-label="Copy link to this section: Advanced: Customized Training" data-title="Copy link to this section: Advanced: Customized Training" data-id="advanced_customized_training"></button></h2>

<p>The above training procedure is simple, but does not give you much control.
It uses teacher-forcing which prevents bad predictions from being fed back to the model, so the model never learns to recover from mistakes.</p>

<p>So now that you've seen how to run the model manually next you'll implement the training loop. This gives a starting point if, for example, you want to implement <em>curriculum  learning</em> to help stabilize the model's open-loop output.</p>

<p>The most important part of a custom training loop is the train step function.</p>

<p>Use <a href="https://www.tensorflow.org/api_docs/python/tf/GradientTape"><code translate="no" dir="ltr">tf.GradientTape</code></a> to track the gradients. You can learn more about this approach by reading the <a href="https://www.tensorflow.org/guide/eager">eager execution guide</a>.</p>

<p>The basic procedure is:</p>

<ol>
<li>Execute the model and calculate the loss under a <a href="https://www.tensorflow.org/api_docs/python/tf/GradientTape"><code translate="no" dir="ltr">tf.GradientTape</code></a>.</li>
<li>Calculate the updates and apply them to the model using the optimizer.</li>
</ol>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="kwd">class</span><span class="pln"> </span><span class="typ">CustomTraining</span><span class="pun">(</span><span class="typ">MyModel</span><span class="pun">):</span><span class="pln"><br>&nbsp; </span><span class="lit">@tf</span><span class="pun">.</span><span class="kwd">function</span><span class="pln"><br>&nbsp; </span><span class="kwd">def</span><span class="pln"> train_step</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> inputs</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; inputs</span><span class="pun">,</span><span class="pln"> labels </span><span class="pun">=</span><span class="pln"> inputs<br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">with</span><span class="pln"> tf</span><span class="pun">.</span><span class="typ">GradientTape</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> tape</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; predictions </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">(</span><span class="pln">inputs</span><span class="pun">,</span><span class="pln"> training</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">loss</span><span class="pun">(</span><span class="pln">labels</span><span class="pun">,</span><span class="pln"> predictions</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; grads </span><span class="pun">=</span><span class="pln"> tape</span><span class="pun">.</span><span class="pln">gradient</span><span class="pun">(</span><span class="pln">loss</span><span class="pun">,</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">trainable_variables</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">optimizer</span><span class="pun">.</span><span class="pln">apply_gradients</span><span class="pun">(</span><span class="pln">zip</span><span class="pun">(</span><span class="pln">grads</span><span class="pun">,</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">trainable_variables</span><span class="pun">))</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="str">'loss'</span><span class="pun">:</span><span class="pln"> loss</span><span class="pun">}</span><span class="pln"><br></span></code></pre></devsite-code>
<p>The above implementation of the <code translate="no" dir="ltr">train_step</code> method follows <a href="https://www.tensorflow.org/guide/keras/customizing_what_happens_in_fit">Keras' <code translate="no" dir="ltr">train_step</code> conventions</a>. This is optional, but it allows you to change the behavior of the train step and still use keras' <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#compile"><code translate="no" dir="ltr">Model.compile</code></a> and <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"><code translate="no" dir="ltr">Model.fit</code></a> methods.</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CustomTraining</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; vocab_size</span><span class="pun">=</span><span class="pln">len</span><span class="pun">(</span><span class="pln">ids_from_chars</span><span class="pun">.</span><span class="pln">get_vocabulary</span><span class="pun">()),</span><span class="pln"><br>&nbsp; &nbsp; embedding_dim</span><span class="pun">=</span><span class="pln">embedding_dim</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; rnn_units</span><span class="pun">=</span><span class="pln">rnn_units</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">optimizer </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">optimizers</span><span class="pun">.</span><span class="typ">Adam</span><span class="pun">(),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loss</span><span class="pun">=</span><span class="pln">tf</span><span class="pun">.</span><span class="pln">keras</span><span class="pun">.</span><span class="pln">losses</span><span class="pun">.</span><span class="typ">SparseCategoricalCrossentropy</span><span class="pun">(</span><span class="pln">from_logits</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code><devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">model</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">dataset</span><span class="pun">,</span><span class="pln"> epochs</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">172/172 [==============================] - 13s 58ms/step - loss: 2.7075
&lt;keras.src.callbacks.History at 0x7f1a9c1b8190&gt;
</pre></devsite-code>

<p>Or if you need more control, you can write your own complete custom training loop:</p>
<devsite-code data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-copy" data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode" track-name="clickToCopy" aria-label="Copy code sample" data-title="Copy code sample"></button></div><pre class="lang-python" translate="no" dir="ltr" is-upgraded=""><code dir="ltr"><span class="pln">EPOCHS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pln"><br><br>mean </span><span class="pun">=</span><span class="pln"> tf</span><span class="pun">.</span><span class="pln">metrics</span><span class="pun">.</span><span class="typ">Mean</span><span class="pun">()</span><span class="pln"><br><br></span><span class="kwd">for</span><span class="pln"> epoch </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">EPOCHS</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">time</span><span class="pun">()</span><span class="pln"><br><br>&nbsp; &nbsp; mean</span><span class="pun">.</span><span class="pln">reset_states</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">batch_n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inp</span><span class="pun">,</span><span class="pln"> target</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">dataset</span><span class="pun">):</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; logs </span><span class="pun">=</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">train_step</span><span class="pun">([</span><span class="pln">inp</span><span class="pun">,</span><span class="pln"> target</span><span class="pun">])</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; mean</span><span class="pun">.</span><span class="pln">update_state</span><span class="pun">(</span><span class="pln">logs</span><span class="pun">[</span><span class="str">'loss'</span><span class="pun">])</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> batch_n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">50</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">template</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> f</span><span class="str">"Epoch {epoch+1} Batch {batch_n} Loss {logs['loss']:.4f}"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="kwd">template</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com"># saving (checkpoint) the model every 5 epochs</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">epoch </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; model</span><span class="pun">.</span><span class="pln">save_weights</span><span class="pun">(</span><span class="pln">checkpoint_prefix</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">epoch</span><span class="pun">=</span><span class="pln">epoch</span><span class="pun">))</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">f</span><span class="str">'Epoch {epoch+1} Loss: {mean.result().numpy():.4f}'</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">f</span><span class="str">'Time taken for 1 epoch {time.time() - start:.2f} sec'</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"_"</span><span class="pun">*</span><span class="lit">80</span><span class="pun">)</span><span class="pln"><br><br>model</span><span class="pun">.</span><span class="pln">save_weights</span><span class="pun">(</span><span class="pln">checkpoint_prefix</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">epoch</span><span class="pun">=</span><span class="pln">epoch</span><span class="pun">))</span><span class="pln"><br></span></code></pre></devsite-code>
<devsite-code no-copy="" data-copy-event-label="" dark-code=""><div class="devsite-code-buttons-container" role="group" aria-label="Action buttons"><button type="button" class="gc-analytics-event material-icons devsite-icon-code-dark devsite-toggle-dark" data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode" track-name="darkCodeToggle" aria-label="Dark code theme" data-title="Dark code theme"></button><button type="button" class="gc-analytics-event material-icons devsite-icon-code-light devsite-toggle-light" data-category="Site-Wide Custom Events" data-label="Light Code Toggle" track-type="exampleCode" track-name="lightCodeToggle" aria-label="Light code theme" data-title="Light code theme"></button></div><pre class="tfo-notebook-code-cell-output" translate="no" dir="ltr" is-upgraded="">Epoch 1 Batch 0 Loss 2.1913
Epoch 1 Batch 50 Loss 2.0591
Epoch 1 Batch 100 Loss 1.9363
Epoch 1 Batch 150 Loss 1.8937

Epoch 1 Loss: 1.9814
Time taken for 1 epoch 12.44 sec
________________________________________________________________________________
Epoch 2 Batch 0 Loss 1.8354
Epoch 2 Batch 50 Loss 1.7515
Epoch 2 Batch 100 Loss 1.6990
Epoch 2 Batch 150 Loss 1.6749

Epoch 2 Loss: 1.7090
Time taken for 1 epoch 11.45 sec
________________________________________________________________________________
Epoch 3 Batch 0 Loss 1.5859
Epoch 3 Batch 50 Loss 1.5785
Epoch 3 Batch 100 Loss 1.5548
Epoch 3 Batch 150 Loss 1.5089

Epoch 3 Loss: 1.5524
Time taken for 1 epoch 11.49 sec
________________________________________________________________________________
Epoch 4 Batch 0 Loss 1.4963
Epoch 4 Batch 50 Loss 1.4674
Epoch 4 Batch 100 Loss 1.4629
Epoch 4 Batch 150 Loss 1.4254

Epoch 4 Loss: 1.4550
Time taken for 1 epoch 11.26 sec
________________________________________________________________________________
Epoch 5 Batch 0 Loss 1.3884
Epoch 5 Batch 50 Loss 1.4480
Epoch 5 Batch 100 Loss 1.3669
Epoch 5 Batch 150 Loss 1.3619

Epoch 5 Loss: 1.3870
Time taken for 1 epoch 11.19 sec
________________________________________________________________________________
Epoch 6 Batch 0 Loss 1.3157
Epoch 6 Batch 50 Loss 1.3346
Epoch 6 Batch 100 Loss 1.3065
Epoch 6 Batch 150 Loss 1.2660

Epoch 6 Loss: 1.3341
Time taken for 1 epoch 11.25 sec
________________________________________________________________________________
Epoch 7 Batch 0 Loss 1.3223
Epoch 7 Batch 50 Loss 1.2794
Epoch 7 Batch 100 Loss 1.2886
Epoch 7 Batch 150 Loss 1.3036

Epoch 7 Loss: 1.2888
Time taken for 1 epoch 11.10 sec
________________________________________________________________________________
Epoch 8 Batch 0 Loss 1.2318
Epoch 8 Batch 50 Loss 1.2245
Epoch 8 Batch 100 Loss 1.2677
Epoch 8 Batch 150 Loss 1.2397

Epoch 8 Loss: 1.2480
Time taken for 1 epoch 11.13 sec
________________________________________________________________________________
Epoch 9 Batch 0 Loss 1.2021
Epoch 9 Batch 50 Loss 1.2654
Epoch 9 Batch 100 Loss 1.2190
Epoch 9 Batch 150 Loss 1.1929

Epoch 9 Loss: 1.2083
Time taken for 1 epoch 11.31 sec
________________________________________________________________________________
Epoch 10 Batch 0 Loss 1.1429
Epoch 10 Batch 50 Loss 1.1642
Epoch 10 Batch 100 Loss 1.1455
Epoch 10 Batch 150 Loss 1.1687

Epoch 10 Loss: 1.1684
Time taken for 1 epoch 11.55 sec
________________________________________________________________________________
</pre></devsite-code>

  

  
</div>

  

  
    
    
      
    <devsite-thumb-rating position="footer"><div class="devsite-thumb-rating" role="form" aria-labelledby="devsite-thumb-label-footer"><div class="devsite-thumb-label" id="devsite-thumb-label-footer">Was this helpful?</div><div class="devsite-thumbs"><button class="devsite-thumb devsite-thumb-up" data-title="Helpful" aria-label="Helpful"><svg class="devsite-thumb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21,7h-6.31l0.95-4.57l0.03-0.32c0-0.41-0.17-0.79-0.44-1.06L14.17,0c0,0-7.09,6.85-7.17,7H2v13h16 c0.83,0,1.54-0.5,1.84-1.22l3.02-7.05C22.95,11.5,23,11.26,23,11V9C23,7.9,22.1,7,21,7z M7,18H4V9h3V18z M21,11l-3,7H9V8l4.34-4.34 L12,9h9V11z"></path></svg></button><button class="devsite-thumb devsite-thumb-down" data-title="Not helpful" aria-label="Not helpful"><svg class="devsite-thumb-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3,17h6.31l-0.95,4.57l-0.03,0.32c0,0.41,0.17,0.79,0.44,1.06L9.83,24c0,0,7.09-6.85,7.17-7h5V4H6 C5.17,4,4.46,4.5,4.16,5.22l-3.02,7.05C1.05,12.5,1,12.74,1,13v2C1,16.1,1.9,17,3,17z M17,6h3v9h-3V6z M3,13l3-7h9v10l-4.34,4.34 L12,15H3V13z"></path></svg></button></div></div></devsite-thumb-rating>
  
       
    
    
  

  
  
</article>


<devsite-content-footer class="nocontent">
  <p>Except as otherwise noted, the content of this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 License</a>, and code samples are licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>. For details, see the <a href="https://developers.google.com/site-policies">Google Developers Site Policies</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
  <p>Last updated 2023-11-16 UTC.</p>
</devsite-content-footer>


<devsite-notification>
</devsite-notification>


  
<div class="devsite-content-data">
  <template class="devsite-thumb-rating-down-categories"></template>
  <template class="devsite-thumb-rating-up-categories"></template>
  
</div>
            
          </devsite-content>
        </main>
        <devsite-footer-promos class="devsite-footer">
          
            
          
        </devsite-footer-promos>
        <devsite-footer-linkboxes class="devsite-footer">
          
            
<nav class="devsite-footer-linkboxes nocontent" aria-label="Footer links">
  
  <ul class="devsite-footer-linkboxes-list">
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Stay connected</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://blog.tensorflow.org/" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            
          
            Blog
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://discuss.tensorflow.org/" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            
          
            Forum
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://github.com/tensorflow/" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
            
          
            GitHub
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://twitter.com/tensorflow" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
            
          
            Twitter
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://youtube.com/tensorflow" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 5)">
            
              
              
            
          
            YouTube
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Support</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://github.com/tensorflow/tensorflow/issues" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            
          
            Issue tracker
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://github.com/tensorflow/tensorflow/blob/master/RELEASE.md" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            
          
            Release notes
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://stackoverflow.com/questions/tagged/tensorflow" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
            
          
            Stack Overflow
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://www.tensorflow.org/extras/tensorflow_brand_guidelines.pdf" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
            
          
            Brand guidelines
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://www.tensorflow.org/about/bib" class="devsite-footer-linkbox-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Footer Link (index 5)">
            
              
              
            
          
            Cite TensorFlow
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
  </ul>
  
</nav>
          
        </devsite-footer-linkboxes>
        <devsite-footer-utility class="devsite-footer">
          
            

<div class="devsite-footer-utility nocontent">
  

  
  <nav class="devsite-footer-utility-links" aria-label="Utility links">
    
    <ul class="devsite-footer-utility-list">
      
      <li class="devsite-footer-utility-item
                 ">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event" href="https://policies.google.com/terms" data-category="Site-Wide Custom Events" data-label="Footer Terms link">
          Terms
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 ">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event" href="https://policies.google.com/privacy" data-category="Site-Wide Custom Events" data-label="Footer Privacy link">
          Privacy
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 devsite-footer-utility-button">
        
        <span class="devsite-footer-utility-description">Sign up for the TensorFlow newsletter</span>
        
        
        <a class="devsite-footer-utility-link gc-analytics-event" href="https://www.tensorflow.org/subscribe" data-category="Site-Wide Custom Events" data-label="Footer Subscribe link">
          Subscribe
        </a>
        
      </li>
      
    </ul>
    
    
<devsite-language-selector aria-label="Select your language preference."><template shadowrootmode="open"><!---->
      <button type="button" aria-controls="language-menu" aria-haspopup="true">
        <svg aria-hidden="true" class="icon-language" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 22q-2.05 0-3.875-.788-1.825-.787-3.187-2.15-1.363-1.362-2.15-3.187Q2 14.05 2 12q0-2.075.788-3.887.787-1.813 2.15-3.175Q6.3 3.575 8.125 2.787 9.95 2 12 2q2.075 0 3.887.787 1.813.788 3.175 2.151 1.363 1.362 2.15 3.175Q22 9.925 22 12q0 2.05-.788 3.875-.787 1.825-2.15 3.187-1.362 1.363-3.175 2.15Q14.075 22 12 22Zm0-2.05q.65-.9 1.125-1.875T13.9 16h-3.8q.3 1.1.775 2.075.475.975 1.125 1.875Zm-2.6-.4q-.45-.825-.787-1.713Q8.275 16.95 8.05 16H5.1q.725 1.25 1.812 2.175Q8 19.1 9.4 19.55Zm5.2 0q1.4-.45 2.487-1.375Q18.175 17.25 18.9 16h-2.95q-.225.95-.562 1.837-.338.888-.788 1.713ZM4.25 14h3.4q-.075-.5-.113-.988Q7.5 12.525 7.5 12t.037-1.012q.038-.488.113-.988h-3.4q-.125.5-.188.988Q4 11.475 4 12t.062 1.012q.063.488.188.988Zm5.4 0h4.7q.075-.5.113-.988.037-.487.037-1.012t-.037-1.012q-.038-.488-.113-.988h-4.7q-.075.5-.112.988Q9.5 11.475 9.5 12t.038 1.012q.037.488.112.988Zm6.7 0h3.4q.125-.5.188-.988Q20 12.525 20 12t-.062-1.012q-.063-.488-.188-.988h-3.4q.075.5.112.988.038.487.038 1.012t-.038 1.012q-.037.488-.112.988Zm-.4-6h2.95q-.725-1.25-1.813-2.175Q16 4.9 14.6 4.45q.45.825.788 1.712.337.888.562 1.838ZM10.1 8h3.8q-.3-1.1-.775-2.075Q12.65 4.95 12 4.05q-.65.9-1.125 1.875T10.1 8Zm-5 0h2.95q.225-.95.563-1.838.337-.887.787-1.712Q8 4.9 6.912 5.825 5.825 6.75 5.1 8Z"></path>
        </svg>
        <span class="label"><!--?lit$127407053$-->English</span>
        <svg aria-hidden="true" class="icon-arrow" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="m12 15-5-5h10Z"></path>
        </svg>
      </button>
      <div id="language-menu" role="menu" hidden="">
        <slot></slot>
      </div></template>
  <ul role="presentation">
    
    
    <li role="presentation">
      <a role="menuitem" lang="en" aria-current="true" href="https://www.tensorflow.org/text/tutorials/text_generation">English</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="es-419" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=es-419">Español – América Latina</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fr">Français</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="id" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=id">Indonesia</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="it" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=it">Italiano</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pl" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pl">Polski</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pt-br" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=pt-br">Português – Brasil</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="vi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=vi">Tiếng Việt</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="tr" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=tr">Türkçe</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ru" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ru">Русский</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="he" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=he">עברית</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ar" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ar">العربيّة</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fa" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=fa">فارسی</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="hi" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=hi">हिंदी</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="bn" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=bn">বাংলা</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="th" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=th">ภาษาไทย</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="zh-cn" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=zh-cn">中文 – 简体</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ja" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ja">日本語</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ko" href="https://www.tensorflow.org/text/tutorials/text_generation?hl=ko">한국어</a>
    </li>
    
  </ul>
</devsite-language-selector>

  </nav>
</div>
          
        </devsite-footer-utility>
        <devsite-panel style="height: auto;"></devsite-panel>
        
      </section></section>
    <devsite-sitemask></devsite-sitemask>
    <devsite-snackbar style="bottom: 0px;">
</devsite-snackbar>
    <devsite-tooltip></devsite-tooltip>
    <devsite-heading-link></devsite-heading-link>
    <devsite-analytics analytics-iframe="">
      
        <script type="application/json" analytics="">[{&#34;dimensions&#34;: {&#34;dimension5&#34;: &#34;en&#34;, &#34;dimension3&#34;: false, &#34;dimension4&#34;: &#34;Text&#34;, &#34;dimension6&#34;: &#34;en&#34;, &#34;dimension1&#34;: &#34;Signed out&#34;, &#34;dimension12&#34;: false}, &#34;gaid&#34;: &#34;UA-69864048-1&#34;, &#34;metrics&#34;: {&#34;ratings_count&#34;: &#34;metric2&#34;, &#34;ratings_value&#34;: &#34;metric1&#34;}, &#34;purpose&#34;: 0}]</script>
<script type="application/json" tag-management="">{&#34;ga4&#34;: [], &#34;ga4p&#34;: [], &#34;gtm&#34;: [&#34;GTM-MXSL34P&#34;], &#34;parameters&#34;: {&#34;internalUser&#34;: &#34;False&#34;, &#34;language&#34;: {&#34;machineTranslated&#34;: &#34;False&#34;, &#34;requested&#34;: &#34;en&#34;, &#34;served&#34;: &#34;en&#34;}, &#34;pageType&#34;: &#34;article&#34;, &#34;projectName&#34;: &#34;Text&#34;, &#34;signedIn&#34;: &#34;False&#34;, &#34;tenant&#34;: &#34;tensorflow&#34;, &#34;recommendations&#34;: {&#34;sourcePage&#34;: &#34;&#34;, &#34;sourceType&#34;: 0, &#34;sourceRank&#34;: 0, &#34;sourceIdenticalDescriptions&#34;: 0, &#34;sourceTitleWords&#34;: 0, &#34;sourceDescriptionWords&#34;: 0, &#34;experiment&#34;: &#34;&#34;}, &#34;experiment&#34;: {&#34;ids&#34;: &#34;&#34;}}}</script>
      
    <iframe sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./Text generation with an RNN  _  TensorFlow_files/analytics-iframe.html"></iframe></devsite-analytics>
    
      <devsite-badger></devsite-badger>
    
    
    <script nonce="">
  
  (function(d,e,v,s,i,t,E){d['GoogleDevelopersObject']=i;
    t=e.createElement(v);t.async=1;t.src=s;E=e.getElementsByTagName(v)[0];
    E.parentNode.insertBefore(t,E);})(window, document, 'script',
    'https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow/js/app_loader.js', '[15,"en",null,"/js/devsite_app_module.js","https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f","https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow","https://tensorflow-dot-devsite-v2-prod-3p.appspot.com",null,null,["/_pwa/tensorflow/manifest.json","https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/images/video-placeholder.svg","https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow/images/favicon.png","https://www.gstatic.com/devrel-devsite/prod/v8332a5cec2b627575422eb634078b4a9892f3eac6f9006e54b6e9bbf0bfda91f/tensorflow/images/lockup.svg","https://fonts.googleapis.com/css?family=Google+Sans:400,500|Roboto:400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700&display=swap"],1,null,[1,6,8,12,14,17,21,25,40,50,52,63,70,75,76,80,87,91,92,93,97,98,100,101,102,103,104,105,107,108,109,110,111,112,113,115,116,117,118,120,122,124,125,126,127,129,130,131,132,133,134,135,136,138,140,141,144,147,148,149,150,151,152,154,155,156,157,158,159,161,163,164,165,168,169,170,172,173,179,180,182,183,186,190,191,193,196],"AIzaSyCNm9YxQumEXwGJgTDjxoxXK6m1F-9720Q","AIzaSyCc76DZePGtoyUjqKrLdsMGk_ry7sljLbY","www.tensorflow.org","AIzaSyB9bqgQ2t11WJsOX8qNsCQ6U-w91mmqF-I","AIzaSyAdYnStPdzjcJJtQ0mvIaeaMKj7_t6J_Fg",null,null,null,["Cloud__enable_free_trial_server_call","BookNav__enable_book_nav_filtering","Profiles__enable_profile_notifications_ui","MiscFeatureFlags__enable_explain_this_code","MiscFeatureFlags__developers_footer_image","ContentExcellence__enable_googler_button","Profiles__enable_release_notes_notifications","MiscFeatureFlags__enable_tls_version_for_gaia_calls","OpenInReplit__enable_replit","Badges__enable_drag_and_drop_badges","Profiles__require_profile_eligibility_for_signin","Profiles__enable_searchable_interests","ContentExcellence__enable_verified_date","AuthorPageInsights__enable_author_page_insights","Profiles__enable_suggested_interests","Cloud__enable_cloud_facet_chat","Search__enable_acl_suggestions","Cloud__enable_cloudx_experiment_ids","Significatio__enable_footprints","Profiles__enable_profile_communities","Profiles__enable_profile_collections","Profiles__enable_developer_profiles_callout","Localization__enable_locale_redirects","Experiments__reqs_query_experiments","MiscFeatureFlags__content_publisher_push_queue","Profiles__enable_page_saving","Search__enable_page_map","Badges__enable_delete_badges","Profiles__enable_developer_profiles_dashboard_recommendations","Search__enable_devsite_serp","Profiles__enable_inferred_interests","Cloud__enable_cloudx_ping","Search__enable_suggestions_from_borg","MiscFeatureFlags__enable_project_variables","Badges__enable_hide_badges","Search__enable_dynamic_content_confidential_banner","Concierge__enable_pushui","MiscFeatureFlags__enable_keyword_inheritance","Cloud__enable_cloud_shell_fte_user_flow","Experiments__enable_experiments","Profiles__enable_awarding_url","Search__enable_faceted_search","SignIn__enable_auto_signin_oauth","Cloud__enable_cloud_dlp_service","MiscFeatureFlags__enable_firebase_utm","BookNav__enable_tenant_cache_key","Profiles__enable_public_developer_profiles","BookNav__enable_collapsible_book_nav","MiscFeatureFlags__developers_footer_dark_image","Profiles__enable_developer_profiles_interests","Significatio__enable_experiment_id_caching","Cloud__enable_cloud_shell"],null,null,"AIzaSyA58TaKli1DculwmAmbpzLVGuWc8eCQgQc","https://developerscontentserving-pa.googleapis.com","AIzaSyDWBU60w0P9hEkr29kkksYs8Z7gvZ8u_wc","https://developerscontentsearch-pa.googleapis.com",2]')
  
</script>
    <devsite-a11y-announce aria-live="assertive" aria-atomic="true"></devsite-a11y-announce>
  
</body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>